#include <cstdlib>

#include "gtest/gtest.h"
#include "testing_common.h"

extern "C" {
    #include "momentum_backend.h"
}

const double RSI_REF_DOUBLE[data_len] = {
        100,               100,               100,               100,
        100, 95.49694290445397, 74.32172829087392, 66.09449819757471,
        67.32661326556118, 44.96242420202085, 70.94593768759356, 66.26034838162398,
        70.27293170584691, 60.52375481541089,  48.1579995913447, 48.23904525781829,
        44.18422944360743, 38.52168605025328, 26.62551824288405, 32.39367758472639,
        36.52455361515574, 35.65258571513624, 34.51177166807546, 29.03639053835173,
        35.57392562029214, 32.10718712646956, 29.57235273641978, 29.02656380701877,
        28.42074512336006, 27.70546390874048,  29.7658422572438, 26.87039693062492,
        25.41162760722516,  38.3270024892251, 43.17403059616922, 47.29637826166613,
        53.9187947171865, 56.80019688957556, 59.31440806487854, 58.29851737101849,
        58.2292114518879, 55.71535050731292, 57.33326040731212,  63.0914030374994,
        61.94626559876193, 63.88166559991815, 62.41951486581721, 61.97025939736061,
        55.49637986392995, 61.57196780551732,  61.4438372226481, 57.53267943660379,
        62.64061669212506, 64.15012407501803, 66.24151442887458, 65.79859046879419,
        56.31454461209751, 58.19502422930108, 61.13388180234291, 57.87523391626372,
        60.26411760122355, 63.04520549858108, 61.32691723100577, 58.54373273206721,
        62.24978084171908, 55.18852090778941, 62.15996213573541, 64.25533547789183,
        63.85573629610384, 59.95822486343185, 61.07471452311975, 63.98834884649459,
        61.68168288792886, 67.62984317093822, 57.26945742865317, 49.46322872317425,
        36.49082095473145, 42.09543368181477, 45.00841148594061,  50.7502256658352,
        47.76504310419615, 47.14086958346746, 57.17364458816847, 49.72700174028013,
        48.61963919128755, 53.83713671476107, 57.58849368460963, 57.59812724375344,
        59.83913069971876, 59.57146103218754, 47.17338609748968, 51.44041170709641,
        48.86779771544636, 50.43733767338896, 54.27670646286779, 53.92767025689529,
        50.02671716276203, 54.12906662091462, 58.43533130146712, 58.40645094830739,
        59.3897227951116, 62.07411262879252, 68.23260879476317, 67.37756226779049,
        60.31260024359108, 61.46561250711137, 62.28645413399221, 64.39960548975995,
        61.17202685122669, 55.79773750490443, 57.04344391728456,  55.2809380162884,
        59.60998631052228, 57.56767298989192, 55.64078290199777, 62.19908549320999,
        62.91002117301364, 53.13699546882194, 55.59150833819607, 62.61011439822697,
        62.66145172028783, 58.09197832901262, 61.11154973913075, 64.33172399359268,
        69.73033712242179,  69.1045402400092, 68.04082627296586, 66.14679287521498,
        67.09177037172132,  68.2759879448741, 72.18678592776698, 70.92372640957943,
        73.81269230196992, 74.15621875630538, 76.63207621936246, 78.46162142992998,
        65.56921980191255, 65.50884853910959, 70.81464200990679, 75.93262468507547,
        76.96766774982505, 76.19051982403332, 76.26723230716996, 77.80095337893161,
        78.29079280650674, 79.69098527070152, 79.05122142547604, 80.78818161148207,
        75.85024891043177, 78.28698391328854, 79.25512947507272,  77.0195702110902,
        68.9980021802558, 66.17286718671403, 65.60894398579518, 70.93244040273443,
        65.95045939280293, 69.84350160221162, 68.44290433732631, 61.48828760411098,
        52.6982991444133, 55.99227667186748, 60.90828748412187, 66.32099631312246,
        59.73990160683827, 61.43618767586844, 63.84438447505811, 64.56247487575271,
        68.19989126833752, 72.13190447187303, 72.55861628631388, 71.12982115320456,
        71.38342504236816, 70.01152510661709, 74.20846974424207, 74.43658994688747,
        78.67900356330955, 78.40566435282047, 79.59897263547032, 80.99926828739549,
        84.58374811410279, 77.70370107552725, 79.18368074571715, 75.95355715600836,
        79.08193317620412, 82.39182079776785, 82.71202086472607, 85.41700802097772,
        77.03716768470589, 74.57053989643769, 76.88981143144777,  78.7569640848244,
        74.73259680802133, 75.43965253149631,  76.4024936070084, 74.51090180657803,
        58.61184962450483, 65.92365803047494, 70.23272171984078,  69.5631892524587,
        52.95334879339486, 52.15943824911142, 59.91774950226627,  61.6276622539544,
        64.01822521659972, 58.60170311942201, 59.67974636769284, 57.61743484393568,
        63.00395404903809, 60.46348110520869, 60.52235271195556, 54.07443201323267,
        57.83111343120567, 54.38812103876946, 47.70847115592598, 37.52809799722397,
        32.46134028103776, 36.63036712504019, 28.65622267713563, 28.60014223102612,
        46.52591016482571, 42.26480931993345,  49.3317820179025, 44.99196919267785,
        43.36453200348652, 35.28677655518963, 44.60543960189016, 41.29493565076542,
        33.86567246147302, 45.42647143789363, 37.04167366908329, 40.56048097065995,
        39.18947930283478, 38.75869543042509, 35.32078725055625, 34.29416873564757,
        42.59896460722052, 42.25149616791016, 46.69940880330714, 43.69762611381092,
        46.16021109193025, 46.00084221153139,  41.9842726783216, 43.57827752913808,
        42.47773612718321, 50.52779847313702, 49.45195801923128, 51.86284507273784,
        52.56731635823419, 54.53056933035245, 59.29119214401961, 58.04856122870628,
        58.80446577013687,
};

float RSI_REF_FLOAT[data_len] = {0};

double AO_REF_DOUBLE[data_len] = {
        0,                 0,                 0,                 0,
        0,0.7245005000000049, 1.405999471428601, 1.505374287500018,
        1.652110500000049, 1.017499600000036, 1.145726509090991, 1.448416708333383,
        2.481461469230823, 2.683999350000079, 3.352333066666773, 1.726124956250146,
        -0.1557061352939684,-2.692109933333143,-5.730419394736657, -8.24749832499981,
        -10.52180719523795,-11.70736128181804,-12.55156476521725,-12.54429106666652,
        -12.23159977999984,-12.58611479615368,-14.14629617037025,-15.19607072857127,
        -15.17403431724119,-16.26383239999981,-16.90512962903205,-16.83896763124977,
        -17.45678601212097, -17.3607917588233,-15.78573329705861,-14.10829185882332,
        -11.21111624705861,-7.032734976470408,-3.183470447058681,-0.4756179205880926,
        2.13211764117662, 3.093734929411909, 3.441559914706033, 4.134647476470718,
        5.319853526470723, 6.470441847058964, 8.320706535294278, 9.646735558823679,
        9.753205123529597, 9.996882173529599, 10.20570685294138,  9.88820725588252,
        10.08670700000019,  10.6486499029414, 11.09588449705902, 11.38767682941196,
        11.38794090294135, 10.38108753823545, 9.981821676470702, 9.322351347058913,
        8.440674888235407, 8.724468691176583, 8.901851829411811, 8.429293694117717,
        7.987881411764732,  7.43211723823535,  6.60779398235303, 6.357234891176574,
        6.415146032353078, 6.343116432353071, 6.567939464705972, 6.920027938235393,
        6.637175555882436, 7.635264420588328, 8.009676411764815, 6.773235550000095,
        3.927941064706005, 1.441793805882497,-2.431176111764557,-4.679117858823389,
        -5.324971623529279,-4.370177332352824,-2.584913229411626,-1.177119620588087,
        -1.042090058823391,-0.3595888147057451, 1.537293397058932, 2.360236270588331,
        3.715765941176585, 5.500678117647169, 5.510972461764823, 4.284531682353048,
        3.025677523529538, 1.361443000000122,0.2966201647060416,0.6422075147060866,
        0.513824920588462,0.8617073294119564, 2.271882688235507,   3.1011457117649,
        3.841999976470817, 5.390265450000214, 7.484853523529665, 9.375000911764971,
        10.15506010588263, 10.89938300588264, 11.71394142941205, 11.65747119411787,
        10.85776461764732, 10.60961774411791, 9.909322414706111,  9.18376398823554,
        8.153174941176701, 7.175264488235513, 6.464059041176711, 6.602500747059082,
        7.291205685294386, 7.100558270588465, 6.272558850000252, 6.992735061764932,
        7.547293373529641, 7.121940823529684, 7.899528876470868, 9.585851661764963,
        10.60608634411793, 11.41864652352967, 12.54367587941204, 13.17114755588261,
        13.57458822352967, 12.96923506764728, 12.53332398235318,  12.5061469735297,
        13.24079428529438, 14.05714740882385, 14.91791283235327, 15.69155886470622,
        15.99332501176505, 15.65082525000031, 14.91782450882383, 15.47464772647089,
        16.12285447647091, 17.27979583823563, 18.90405811764742, 20.95367568235332,
        21.00014710588275, 20.55994022647101, 20.22891177647094, 20.26203149411799,
        19.80903342058852, 19.73226860882389, 19.65797480294157, 19.27479733823566,
        18.0085305882356,  16.7440886264709,  15.2634101558827, 13.86737957647088,
        12.37334888823557, 11.94332221764736, 11.87388018529444, 11.77570588235324,
        9.825089802941477, 8.441176900000357, 7.107266423529779, 6.570354161765067,
        6.127234808823971, 7.342497914706314, 8.092617061765168, 8.435232550000421,
        8.395585085294613, 9.692764076471121, 11.15308654705933, 12.19934986176514,
        13.14052615588287, 13.81323321176518, 13.74249565294167,  13.6826769441181,
        14.1395621382357, 15.39982587058876, 16.17835645588281, 17.11797306764748,
        18.85597127352986, 20.04846795294162, 20.14385010000035, 21.16746800588277,
        21.97894096470628,  22.8388231647063, 23.83400176470639, 25.86985573529455,
        27.45115089705928, 28.38306090588281, 28.05597291176514, 27.86076500882399,
        27.05370505882399, 26.25676103529463, 25.51702637647105, 25.10449398529454,
        22.10093603235339, 20.30073073235337, 19.82432098823574, 19.01511544705926,
        16.68344163529457, 15.47429448235346, 14.46229630882397, 12.64647385000046,
        11.66179837941229, 11.52273868235346, 12.38482737941229, 12.12176515882413,
        11.38343952647119, 10.59008649411828, 10.24264770588297, 9.369970497059455,
        8.585678520588885, 7.125323835294807, 4.746265452941884,-0.7417655088228798,
        -5.252204976469955,-11.06532282352873,-18.82826317941112,-27.24158792058756,
        -28.05247022647001,-27.37347163529347,-25.67008957352874,-21.96876600294047,
        -17.42205836764646,-19.86655915588176,-22.10070543235224,-25.20717729117587,
        -30.77950013823465,-33.10956026176405,-35.58159047058751,-39.58247437352867,
        -43.79450264999926,-43.88200296470518,-46.96335670588155,-50.19270839411692,
        -49.36999969117571,-45.75111625882278, -42.7268221911757,-38.38135206176403,
        -30.08152889117582,-24.94741281764635,-24.05211845882283, -23.8875893676464,
        -23.29847144117585,-20.74926643235233,-17.45370548235235,-11.69841167352888,
        -5.011996911764129, 1.266356202941779,  6.97617976764775, 10.85835442941243,
        14.88122216176532,
};

float AO_REF_FLOAT[data_len] = {0};

double KAMA_REF_DOUBLE[data_len] = {
        199.25, 199.3445469344449, 199.4802105151442, 199.6608763040859,
        200.1845040998202,  200.624765506065, 200.8239509355197, 200.9412768399057,
        201.0751663572078, 201.0712723830334, 202.1036024588368, 202.4512592153461,
        203.0585118994481, 203.1822928744588, 203.1743672683456, 203.1681590393187,
        203.1089182509667, 202.8822052932789,  201.082850402477, 200.4072215445904,
        198.8965104603911, 197.5211759382939, 195.5842949093624, 192.5753595638516,
        191.8242960003103, 190.4680211354799, 188.7896200672369, 187.4287923819618,
        186.8740524101346,   185.62880772485, 184.3464922175256, 182.5246611199901,
        180.6613052861478, 180.6390414618278, 180.6906648379149, 180.7645686499076,
        181.7057621884556, 183.1978593840955, 185.2223662291528, 186.8450218270834,
        188.1079083544579, 189.1940815400181, 190.6977139867807, 193.1118741302086,
        194.3590406057747, 195.6513791182359, 196.1629875946218,  196.444295953179,
        196.4359706568786, 196.6600703868151, 196.8637994928526, 196.9241126152163,
        197.3160042487841, 197.5692893949925, 198.1145624013278, 198.4575287733248,
        198.4736194331819,  198.527838920968,  198.931117895982, 198.9800891319449,
        199.1164963930172, 199.6474596757923, 199.7956943635355, 199.8230526465401,
        199.8931162811982,  199.928720618972, 200.5047490351961, 201.1991200213832,
        201.6317010247961, 201.9256855553134, 202.1908230445445, 202.5347575885533,
        202.8008955056872, 203.9764622420666, 204.0579673073147, 204.0575945985128,
        202.8585937952643, 202.3974390869591, 202.2185747247983, 202.2366035908589,
        202.2014781436904, 202.1250649709358, 202.1558204976787, 202.1784369639019,
        202.1677147711783, 202.2095787834627, 203.1428892814566, 203.8058818792162,
        204.6312372005785, 205.1099728577823, 205.0893953435791, 205.1225857486157,
        205.1012346883922, 205.1075473683602, 205.2661795150871, 205.3110654706961,
        205.3222608017109,  205.352154203758, 205.3986583426071, 205.4485734821067,
        206.6319647038901, 207.8657848078342, 212.0031910712647, 214.5979498275946,
        214.9456917704994, 215.4334632437433, 216.4067867461581,  217.505170907286,
        217.7848491822773, 217.7831577246531, 217.8125804716015, 217.8114975393572,
        217.8786723081986, 217.9309679452988, 217.9349645551095, 218.1375066406852,
        218.3441243055527, 218.3598885619782, 218.3712698395631, 219.0065096878427,
        219.5381347368713, 219.7535489535705, 220.0397593883891, 220.8103086540864,
        222.9502179601185,   224.19380836685,  225.107854731127, 226.9391253257577,
        228.5222349288338, 229.6145749389537, 231.5850565518869, 233.8947955799562,
        236.4946217255862, 238.3312138690084, 240.2055441119259,   242.63212979273,
        242.682937584016,  242.739359558797, 243.5851024384341, 245.8340330925449,
        247.7886504431211, 249.3982942447121, 250.5633479379817, 252.0056527410332,
        253.1803598888384, 254.4514739208319, 257.4130114279371, 260.2488414825364,
        260.8708602638612, 261.9434759206456, 263.0523738012643, 263.6627665516768,
        263.6296766730256, 263.5900365113608, 263.5619095789031,  263.670911144044,
        263.6816985687144, 263.7848149816891, 263.9225014631473,  263.925447608853,
        263.6298191205062, 263.5736892093927, 263.6023636021224, 264.0068634941333,
        264.0781831058292,  264.127638995968, 264.3700550858045, 264.5138662299075,
        265.0173577792796, 266.8734104574981, 270.3494220369332, 272.3986562739055,
        273.8523377165344, 274.5134978100468, 277.8133227265849, 280.0181272529667,
        283.5448876163472, 285.7141409928597, 287.6730887103218, 289.5977320266974,
        293.3964607094624, 294.3733765344753, 295.7608444580382, 296.3528837712855,
        297.9031506503487, 300.9593067905784, 303.1560028893152, 306.9042440936734,
        307.8122597240305, 308.2392146557422, 308.9661411494862, 310.7483601691047,
        311.4688728627564, 312.4557600475924, 313.3839813046816, 313.7297146142996,
        313.6923335006296, 313.7156951869734, 314.3458092408927,  314.995875792885,
        314.8955924141219, 314.6564137501245, 314.6902660354741, 314.7649026404223,
        314.9325949820508, 314.9661861815623, 315.2406885629469, 315.2751775104238,
        315.3945544468847, 315.4499818034295, 316.4379519991683, 316.5573304123006,
        316.7063668380686, 316.7314814060887, 316.5039907922471, 314.5027609225149,
        310.0242099173716, 308.1085783152162, 299.0383745773699, 292.4300499646595,
        292.766005330238, 292.5589692298088, 292.8932146729243, 292.8943831087691,
        292.7475351704647, 291.3823703284124, 291.3461626489586, 291.0238563564121,
        289.7543631030499, 289.6775141486363, 286.6501360965553, 285.4953299764581,
        282.9262449215639,  280.768676515239, 277.1295893942233, 274.5544211680511,
        273.3856757128119, 272.4810024038707, 272.3172702806799, 271.1996507197942,
        270.8527335239854, 270.7600154820648, 270.4449885271968, 270.3355614165787,
        269.6394332513063, 268.9903724741143, 268.7397408024637,  268.617664157929,
        268.6045528826943, 269.0108809956554, 270.9737997063066, 272.2310224264446,
        275.727126102114,
};

float KAMA_REF_FLOAT[data_len] = {0};

double ROC_REF_DOUBLE[data_len] = {
        -1,               -1,               -1,               -1,
        -1,               -1,               -1,               -1,
        -1,               -1,               -1,               -1,
        6.273525721455458, 2.633776826815904,-0.4905327161261026,-0.7969515513467593,
        -3.258143016351323,-4.817537559035764, -9.52844801991645,-7.655408110786967,
        -6.690779010357377,-5.277319034009252,-10.22230837502739,-12.45995636987682,
        -11.8772108618654,-12.32732036314889,-11.43645710619908,-11.79398408459292,
        -11.20466564764515,-10.04158063845757,-3.995260585853644,-7.203433007453971,
        -9.228993916079965,-5.492425762916405,-3.417993121693117, 1.163365037159093,
        1.902458674090281, 5.361638611235578, 8.432591374093491, 8.504219095355538,
        8.932277594844356, 8.659375108259798, 8.743688018894753,  13.3546518907719,
        14.17772162415946, 11.03318198081264, 8.896683807805337, 7.213044448693212,
        2.850388204587591, 3.749091767067277, 2.530674529343196, 1.920797137640485,
        3.811490717841594, 5.183143478698158, 5.425759479218935, 2.912571976506507,
        1.086576567609461,0.8924084716391324, 2.238654302438142, 1.596332947967234,
        3.952546772675628, 2.707709669053402, 2.383095464526499, 2.743536810262102,
        2.039196695025593,-0.06905736830379376, 1.374686632264833,  2.25725901693697,
        4.324564457063, 2.872191838794679, 2.219165029162327, 3.930603717472117,
        2.69552184905772, 3.815596575658232, 1.921756968215157,0.3294801968188742,
        -5.990473480687073,-2.759265566104268,-3.947499257081843,-2.590501390356288,
        -3.680449069635778,-3.159118864667783,0.5920843219388581,-3.305033017623191,
        -3.371967637570497,-3.069842853402652,0.9211788439680134, 3.107536945249747,
        9.982416157699712, 7.847719289340096, 1.808684750104457, 1.504208870517928,
        1.577192358396125, 2.518956055845095,0.01913863224798816, 2.954379778051786,
        1.962918559459736, 1.302664406779657, 1.392913200107062, 1.378586226570703,
        0.7195254924733158, 1.995665000613506,  10.3385299562699, 8.039125670997983,
        7.146353700110632, 6.991677647991419, 5.593034916822994, 6.721279421258998,
        7.41857570372254, 4.082410210025242, 2.550638609108392, 2.072586562707174,
        3.20306348417672, 1.472082161588582,-2.133364231555337,0.3944618834454516,
        2.669712457142863,-0.4274611303536471,0.0543769830681093, 1.903304270713217,
        2.760676505590451, 3.063426318163342, 3.799377268656837, 5.701030594943108,
        6.867849644246701,  7.26726821259388, 7.540443959495898, 4.643476337708278,
        4.759785916733348, 7.969490519791587, 8.916759068846511, 5.704599923012195,
        7.099442941067932, 8.547240870247089, 8.611198117478741, 8.240256999265622,
        2.997326866003615, 3.133081848753173, 5.711366479774071, 9.152200562192279,
        9.444067109163834, 8.764434943286069, 6.956049789115822,  8.11384623771912,
        6.974266999012542,  7.64430981489195, 6.237322116657293, 6.191526928028193,
        7.95348043764381, 9.249369178026999, 7.372572507086601, 4.092722114576438,
        2.209709514563104, 1.897874579048074, 1.764892387066256, 2.675096244557965,
        1.595292442802386, 2.151023547626676, 2.019395778647739,-0.1172144284145141,
        -1.21459138661715, -1.51265045482202,-0.569082353371415, 1.659837714752567,
        1.417231267014463, 2.469371685455822, 3.434177566789599, 1.910874383580622,
        4.109116739255927, 4.487749843007021, 4.924229747427508, 5.897935252908295,
        7.928300654694127,   6.7624408482632, 6.935768469632459, 5.009049702934683,
        8.613063794508371, 7.940992299795457, 7.663330813223913, 8.174318034218159,
        9.158645302387329, 6.278142264604219, 6.914868843267079, 6.666914158394024,
        8.274413938356373, 10.80375135410999, 9.271122183098598, 11.49963178139075,
        7.854157733722086,   7.4327152836183, 8.136663657736337, 8.540785803659849,
        5.400366464450801, 6.815055467523072, 6.480995256077198, 6.675820905066143,
        1.899802091758957, 2.603105923148505, 4.514552117710742, 2.180087139136754,
        -1.013810627787753,-0.8607927135709124, 1.145164355575582, 0.853387163469845,
        2.729249078861734,0.7333921661922883,0.7267415092749517,0.4084028174320768,
        5.907104480060677, 2.260062625452099, 0.188079178492692,-1.503688231446083,
        4.558813784407165, 3.771134532869367,-1.819042775868733,-7.239078591168319,
        -11.41723963824961,-8.555449515843664,-14.93702403745696,-14.47076191940624,
        -8.676654327262067,-10.94283514856459,-6.834904194433461,-8.175544514106587,
        -10.68846070527874,-16.89977428285136,-8.851618930584339,-7.629619871914076,
        -13.83296056591394,-5.016228703561828,-11.44705442350688,-7.499262922479303,
        -17.44921533716553,-15.39472104326334,-24.27825441891571,-23.40229924815687,
        -14.58325922770389, -7.75820264922179,-9.427347857676423,-10.05336699115409,
        2.650768281847778,-8.518907765158447,-0.5367255532097003,-3.136125907078524,
        -2.132401201057295,  7.22689846893905, 13.16959838663414, 18.58537813846276,
        8.550706647952298, 11.29439375538622, 11.07026225762063, 14.80987618451046,
        12.46026460861241,
};

float ROC_REF_FLOAT[data_len] = {0};

double STOCH_REF_DOUBLE[data_len] = {
        24.55525753230332, 94.81328554087163,  94.8122860910816, 93.57362471873074,
        97.06198105288769,  86.6936263495213, 67.74195922216921, 57.86296529495269,
        60.98794576369882, 21.27016557866228, 71.40302089552235, 63.22385671641783,
        78.74628059701489, 59.22386865671637, 25.44910636810295, 23.39502285093005,
        21.76942791509748, 19.56517379729558, 8.841638038604534, 17.89895080688861,
        24.86134931887841, 22.27356063427249,  18.9463817489542, 8.021687354315967,
        19.52427549031134, 7.921420271364409, 5.961992005284624, 3.917605538669333,
        1.52560127320021, 5.373852710941204,  10.0656560002654,0.4576774502694821,
        13.64864598855578, 42.20719038835902, 55.27022818967053, 72.46730124445044,
        91.82445962802575, 88.88448605419825, 95.37504008939608, 92.96541670663296,
        90.04524851047255, 84.72854570188542, 89.06487480066444, 93.87076391000672,
        91.93871123670291, 96.20964365949007, 92.13821935904143, 88.48298734749309,
        71.76472934883678, 92.18132771476169, 83.76218854935627, 67.61306384629489,
        79.28117275811523, 87.59683754801446, 99.43621572428242,  93.4159121871689,
        48.73353026014706,   60.776369051346, 81.10312258139898, 65.98571053407603,
        81.8182087473055, 93.76192934557102, 82.22956561359054, 69.53647230385701,
        95.0331445989279, 51.66865348264721, 99.88667790174863, 99.33325714285741,
        95.53075933962695, 79.50137770070387, 81.77663585652667, 89.42724786043532,
        79.17131392726908, 56.54667256616312, 31.93053085655888, 12.10739721752641,
        2.639785289284393, 15.35254975574324, 22.43832084294014, 37.68667467199452,
        29.211549304649, 27.44006919348677, 56.92949977445287, 35.32476718559813,
        31.81662114332572, 48.35012637898176, 61.72284932476369,   69.862479748033,
        95.20647658527824, 90.94238334858187, 42.77397739427187, 61.44520403617945,
        32.76656231965342,   41.726629574033, 64.48656534385077, 61.40829074927809,
        40.82598081896256, 64.45498592959082, 91.36902658199017, 91.22018731842458,
        85.29790345882078, 99.49301644442431, 99.47155014086972, 86.90006977970658,
        66.79653251812957, 71.77486346206801, 75.23808126159011, 83.55858336377256,
        75.4054426223571, 60.85584155709574, 59.68586058496048, 43.06182329357716,
        64.88597941197494, 57.45926495982956, 48.33449592185347, 73.93618549118224,
        67.58923238997311, 17.32145999681956, 43.46832497122229, 90.75625385981787,
        80.608126168751, 62.63511159603637, 80.40543005845684, 97.71387283746705,
        93.64730172740161, 90.17386956521729, 87.78261739130431, 83.65213043478251,
        87.60866956521735, 92.52173478260859, 98.14381283836043, 91.72519149617774,
        99.68986056128355, 94.04005402833153, 99.33038374920997, 99.15291405536155,
        71.22490929508814, 62.78667284556505, 94.01809776106992, 99.51611958048743,
        98.58009788150581, 95.70329515227358, 96.02505589014625, 96.01553676176255,
        98.70583731920362,  98.9290403183561, 96.74885411343685, 98.87355394279757,
        91.88997397176909, 99.92991235204613,  98.9062412267975, 94.43724553720794,
        74.4692196325307, 52.57333627342212, 50.75218893420851, 87.09418563175564,
        66.72652021158034,  98.5649857748801, 92.28395141111612, 47.89817995043595,
        26.4214496482482, 45.56843730066335, 77.67545978922574, 98.02848961634308,
        72.26383755095421, 82.86886103465318, 97.77166058845253, 93.23904275534541,
        99.21097230039028, 96.20398367346937, 94.66253505693491, 91.56577405258139,
        92.65909370895773, 87.82248168957607, 98.93932997134876, 97.20204924150738,
        99.72075396708115, 85.65033231077058, 91.28420275534523, 98.79922299419643,
        99.2487980543509, 89.31576807869958, 96.61296287319271, 88.76463988623817,
        95.17001620247044, 97.48983958108546, 93.13976848148566, 99.70022898085163,
        85.88740303966588, 81.04651065508224, 92.79747583354388, 99.97022970383436,
        91.69497627118632, 91.59332290503791, 97.21006138401671, 83.58407084999739,
        45.05164562009841, 78.44864859102115, 84.71915608536534,  82.6730046724857,
        20.15674705456058,  25.1268113291433, 64.88490735760681, 75.02929086435996,
        89.69951429974358, 69.48885885898174,  75.4193649201394, 67.85009991219269,
        97.46393338588895, 88.37295973996106, 88.68516022529064, 65.47013549158491,
        85.59997599999997, 72.31994799999984, 43.31994799999984,  23.5587900918111,
        4.74563686986008, 15.86758246459796, 1.032063945436072, 23.98022379842844,
        59.90119887922096,  46.5067173035948, 66.38509809147325,  52.5068375217727,
        47.83246115747595, 14.35269206726258, 42.42823875846861, 29.74405890060861,
        0.409391293444981, 53.51785892857147, 3.453135937499985, 22.04269158146116,
        14.27930963820951, 11.45335440689637, 1.631585526315785,  12.9529627786181,
        39.41799991297447, 42.07901863605534, 62.07503776141083, 47.58228839791021,
        61.50706456784724, 61.92242544838651, 42.04426972914518, 64.79550747294674,
        57.73859132166207, 98.73270454897576, 79.23503686604494,  90.4721544221746,
        93.72140580579679, 98.85783782435172, 97.66307330129618,  92.5608441019462,
        96.70885724920851,
};

float STOCH_REF_FLOAT[data_len] = {0};

double STOCH_SIGNAL_REF_DOUBLE[data_len] = {
        24.55525753230332, 59.68427153658747, 71.39360972141885, 94.39973211689465,
        95.14929728756668, 92.44307737371325, 83.83252220819274,  70.7661836222144,
        62.19762342694023, 46.70702554577125,  51.2203774126278, 51.96568106353413,
        71.12438606965168, 67.06466865671636, 54.47308520727807, 36.02266595858312,
        23.53785237804349,  21.5765415211077, 16.72541325033253,  15.4352542142629,
        17.20064605479051, 21.67795358667983, 22.02709723403503, 16.41387657918088,
        15.4974481978605,  11.8224610386639, 11.13589592232012, 5.933672605106122,
        3.801732939051389, 3.605686507603583, 5.655036661468936,  5.29906205382536,
        8.057326479696886, 18.77117127572809, 37.04202152219511, 56.64823994082666,
        73.18732968738223, 84.39208230889146, 92.02799525720667, 92.40831428340908,
        92.79523510216718, 89.24640363966364, 87.94622300434078, 89.22139480418549,
        91.62478331579132, 94.00637293539988, 93.42885808507812, 92.27695012200816,
        84.12864535179041, 84.14301480369716, 82.56941520431822,  81.1855267034709,
        76.88547505125543, 78.16369138414149,   88.771408676804, 93.48298848648854,
        80.52855272386607,  67.6419371662206, 63.53767396429729, 69.28840072227361,
        76.30234728759345, 80.52194954231747, 85.93656790215563, 81.84265575433948,
        82.26639417212509, 72.07942346181066, 82.19615866110786, 83.62952950908436,
        98.25023146141096, 91.45513139439605, 85.60292429895246, 83.56842047255525,
        83.45839921474364, 75.04841145128913, 55.88283911666364, 33.52820021341608,
        15.55923778778984, 10.03324408751796,  13.4768852959892, 25.15918175689258,
        29.77884827319449, 31.44609772337671, 37.86037275752949,  39.8981120511792,
        41.35696270112552, 38.49717156930182,   47.296532282357, 59.97848515059277,
        75.5972685526916, 85.33711322729766, 76.30761244271062, 65.05385492634436,
        45.6619145833682, 45.31279864328858, 46.32658574584568, 55.87382855572057,
        55.57361230403043, 55.56308583261043,  65.5499977768478, 82.34806661000179,
        89.2957057864118, 92.00370240722317, 94.75415668137157, 95.28821212166685,
        84.38938414623527, 75.15715525330137, 71.26982574726254, 76.85717602914356,
        78.06736908257325, 73.27328918107513,  65.3157149214711, 54.53450847854446,
        55.87788776350419, 55.13568922179388, 56.89324676455266, 59.90998212428843,
        63.28663793433626, 52.94895929265829, 42.79300578600498, 50.51534627595322,
        71.61090166659703, 77.99983054153505, 74.54955594108138, 80.25147149732005,
        90.58886820777514, 93.84501471002862, 90.53459622797436,   87.202872463768,
        86.34780579710134, 87.92751159420277,  92.7580723953954,  94.1302463723822,
        96.51962163194054, 95.15170202859758, 97.68676611294167, 97.50778394430101,
        89.90273569988653, 77.72149873200489, 76.00989330057435, 85.44029672904077,
        97.37143840768768, 97.93317087142225, 96.76948297464185, 95.91462926806075,
        96.91547665703742, 97.88347146644071, 98.12791058366547, 98.18381612486344,
        95.83746067600111, 96.89781342220421, 96.90870918353751, 97.75779970535046,
        89.27090213217866, 73.82660048105353, 59.26491494672039, 63.47323694646204,
        68.19096492584811, 84.12856387273864, 85.85848579919212, 79.58237237881065,
        55.53452700326668, 39.96268896644909, 49.88844891271236, 73.75746223541064,
        82.65592898550761, 84.38706273398344, 84.30145305801993, 91.29318812615035,
        96.74055854806272, 96.21799957640167, 96.69249701026484, 94.14409759432856,
        92.962467606158, 90.68244981703839, 93.14030178996084, 94.65462030081073,
        98.62071105997909, 94.19104517311969, 92.21842967773232, 91.91125268677074,
        96.44407460129752, 95.78792970908229, 95.05917633541439, 91.56445694604348,
        93.51587298730043, 93.80816522326467, 95.26654142168049, 96.77661234780756,
        92.90913350066769, 88.87804755853323, 86.57712984276397, 91.27140539748682,
        94.82089393618817, 94.41950962668618, 93.49945352008029, 90.79581837968398,
        75.28192595137084, 69.02812168703898, 69.40648343216162, 81.94693644962406,
        62.51630260413719, 42.65218768539651, 36.72282191377021, 55.01366985037001,
        76.53790417390344, 78.07255467436174, 78.20257935962157, 70.91944123043795,
        80.24446607274035,  84.5623310126809, 91.50735111704689, 80.84275181894556,
        79.9184239056252,  74.4633531638616, 67.07995733333324, 46.39956203060361,
        23.87479165389036, 14.72400314208973, 7.215094426631386, 13.62662340282084,
        28.3044955410285, 43.46271332708142, 57.59767142476303,  55.1328843056136,
        55.57479892357399, 38.23066358217043, 34.87113066106907, 28.84166324211329,
        24.19389631750742, 27.89043637420838,  19.1267953865055,  26.3378954825109,
        13.25837905239024, 15.92511854218904, 9.121416523807246, 8.679300903943444,
        18.00084940596947, 31.48332710921599, 47.85735210348023, 50.57878159845882,
        57.05479690905612, 57.00392613804801, 55.15791991512634,  56.2540675501595,
        54.85945617458469, 73.75560111452823,  78.5687775788943, 89.47996527906514,
        87.80953236467217, 94.35046601744108, 96.74743897714826, 96.36058507586473,
        95.64425821748368,
};

float STOCH_SIGNAL_REF_FLOAT[data_len] = {0};

double TSI_REF_DOUBLE[data_len] = {
        -1,               100,               100,               100,
        100, 99.80684591211411, 98.48575937543973, 96.76779220607095,
        95.32798496643306, 91.53418919196513, 88.74558571375334, 85.66390674866177,
        83.32708034374488, 79.41881895364364,  72.9106692700683, 67.75122003712363,
        62.34083197092774, 56.00060334092897, 45.01664966387137, 37.21050704265031,
        31.66727829587477, 26.95870326927102,  22.7473090129396,  16.9935810467681,
        13.42726104690767, 9.196350907560589, 4.748956199758143,0.9739722418161236,
        -2.327683089903839,-5.314124931904976,-7.442366692717176, -10.2678096705151,
        -13.17083660659704,-12.89806032870499,-11.47868561556124,-9.246312269435812,
        -5.503561736792527,-1.617865567609877, 2.291157072624194, 5.186502944024525,
        7.529884844987375, 8.874569423891513, 10.40212876883171, 13.29118648226561,
        15.37975400954644, 17.65564207739633, 19.19529076246967, 20.37606249386679,
        19.73431346073363, 20.74818459161326, 21.53979916200257, 21.15040523380675,
        22.18913399607157, 23.46713727073869, 25.12657909468604,  26.3716126016414,
        24.73391949017347, 23.87869979340122, 23.95783591498438, 23.08071496174665,
        22.98976962554833,  23.6873847646817, 23.78619622632128, 23.09556527161436,
        23.50732978627916, 21.74940960123522, 22.34235512715684, 23.48410730754601,
        24.27168896073234, 23.77978436730537, 23.68743684520485, 24.44027398115555,
        24.41538660944908, 26.21610305379556,  24.3786098770322,  20.0148156229557,
        10.35938506815579, 5.165857876742395, 2.327344618208819,  2.15375347677972,
        0.9560842650516359,-0.167205721328575, 2.456983611383146, 1.884676452059076,
        1.068004347955841, 2.205331552574056, 4.429313791280993,  6.13883983457786,
        8.24667155947744, 9.851985936192941, 7.270500088025493, 6.547333718366915,
        5.130558801773569, 4.472428392141178, 5.100416694789202, 5.501433861123447,
        4.700716889259735, 5.229403490164722, 7.012206335935317, 8.430694135842019,
        9.885548141906241,  11.9104621402952, 15.75595298728865, 18.60125692659411,
        18.97089289879637, 19.61248192040578, 20.37381358507664, 21.62458588726474,
        21.78852637927721, 20.37506868106934, 19.54101737304403, 18.35042661953779,
        18.50628925103183, 18.06597041607823, 17.16293269397642, 18.26790226650295,
        19.37867636886216, 17.34436572093259, 16.40879682107873, 17.89372012187568,
        19.06590188353843, 18.63980044958066, 19.21478568059191, 20.71667730458773,
        23.90446288336805, 26.19814509309954, 27.72566094952652, 28.44226835866872,
        29.3049446509018, 30.36220284665318,  32.4834889307072, 33.87590594351871,
        35.9685068615559, 37.78455001896508, 40.12803503403462, 42.70888967607047,
        40.93326151201485,  39.5179877931283,  39.9377131687985, 42.14727765407525,
        44.23426401218259, 45.61071533493503, 46.72507266757626, 48.12950435175433,
        49.42523701424316, 50.94497769070095, 52.01951603534979, 53.46129983738107,
        53.30798571255245, 53.87867957974647, 54.63687584823401, 54.63946106441968,
        52.27259613536865, 49.46226305287309, 46.99186885357372,  46.2371175122774,
        44.07519665126431, 43.38195835888455, 42.40007685597333, 39.36836286362509,
        33.69419320592239, 30.07742948227711, 28.61404435124817, 29.25392084761107,
        27.46023340936303, 26.62046678094459, 26.73207777280008, 27.04567511196767,
        28.48923326774733, 31.08015247383833, 33.25547511768775, 34.58709393900264,
        35.74219349315447, 36.33023718863984, 38.13205305376467, 39.66474137028872,
        42.46090266367423, 44.61001308697989,  46.7866275499182, 49.07564880097794,
        52.46864239051786, 53.03091050736565, 53.97231091541599, 53.72135378607194,
        54.52075607848178,  56.4023096174835, 57.96069995823458, 60.30652605796229,
        59.27689087800611, 57.64594873908544, 57.04633890322823, 57.16622119723404,
        55.96114607710069, 55.20822693237316, 54.87341797448687, 54.05227918566348,
        47.90946979181345, 44.96806963492627,  44.1026677767932, 43.22373263015444,
        35.82662986011563, 30.09303094022168, 28.06130423764582,  27.1237438644556,
        27.20858889455722, 25.42509382595125, 24.37525219334007, 22.88921613564941,
        23.32956401251638, 22.89127063644067, 22.56076663822475, 20.30257590579686,
        19.52414067865546, 17.82419451448941, 14.17375055407016, 6.965259530683731,
        -1.026131118983833,-5.774337958982291,-13.33160636084002,-18.81041821161025,
        -16.47445585390538,-16.39222198264859,-13.47084758295677,-12.88124400661778,
        -13.0233030794638,-16.29868704785958,-15.26187075099813,-15.72889954558588,
        -19.14665279977076,-17.07396746454011,-19.07741075850286,-19.07727769075203,
        -19.59206671007829,-20.12451272039715,-21.74103707354038,-23.34332724003437,
        -21.93919375878106,-20.95714216233963,-18.72629964751238,-17.78954594125661,
        -16.27219417483321,-15.09693038519928,-15.23078041020722,-14.89182442797406,
        -14.90951415820595,-12.53277227164395,-10.88592921021798, -8.80191857604945,
        -6.879078305512659,-4.696768219468287,-1.355698815003685,  1.09585689752755,
        3.359808082020405,
};

float TSI_REF_FLOAT[data_len] = {0};

double UO_REF_DOUBLE[data_len] = {
        -1,               -1,               -1,               -1,
        -1,               -1,               -1,               -1,
        -1,               -1,               -1,               -1,
        -1,               -1,               -1,               -1,
        -1,               -1,               -1,               -1,
        -1,               -1,               -1,               -1,
        -1,               -1,               -1,               -1,
        38.57333426376323, 37.40314937994793, 38.85648838383906, 30.94664389976653,
        35.89500672093099, 44.94021560769765, 47.43822680850729, 52.70561312842181,
        56.14616880718886, 55.53791771233406, 58.21465340667706, 60.75025082973013,
        53.62454717631981, 55.28959190859446, 53.98708348373528, 54.43278160485291,
        52.73746371704077, 52.86491963559783, 52.99263797238806, 52.20402687943017,
        45.22621381892126, 48.64292742380087, 40.99589975846914, 41.57959881594651,
        42.79098247157903, 46.24101723239757, 50.90933989333033, 55.97620537655418,
        47.79218375349333, 52.43372445399375, 56.44244536811886, 51.86496960549639,
        52.56616240778984, 52.32307665728884, 51.68640090124219, 51.34165737419659,
        52.48256256687556,  43.1795241997078, 55.55538003304117,  57.0816952700016,
        56.9057958469694, 53.87495138662002, 54.70259805989227, 52.49512621280275,
        57.7996641897474, 45.64599205172011, 36.70429032353774, 35.17148935206443,
        30.72758363092545, 34.32671185869724, 37.87364919720765, 42.05282071160823,
        41.82089404116795, 45.79963474059452, 51.80797642023229, 54.11685060971181,
        51.36762265264559, 51.61534367078324, 49.81822092920325, 48.33838795015232,
        50.87097587633379, 46.65032730536247,   45.488012395887, 49.12596997772351,
        41.28019155576919, 40.74514620725255, 46.68784607560939,  45.4228908980871,
        42.86516879410093, 55.72067459147938, 57.18247314660776, 60.88345667714007,
        58.31094442168959, 61.83652106043371, 68.55989365125846, 66.98124897439597,
        63.00042366349393, 62.27628045759818, 65.43892172267562, 68.59094924804111,
        60.60333384833552, 47.02598019272862, 50.47452642789515, 46.45284909134811,
        48.58778062914098, 46.79775550318265, 42.21041063854525, 50.05403906765687,
        48.79294664411288, 44.21538676146822, 55.79813066400339, 58.33439177360288,
        56.19603809739786, 51.98437147253304, 50.78459584579564, 57.48098747421515,
        66.24727421116479, 61.86029308024431, 53.85493925825236, 56.06332525122081,
        61.6542999309586, 59.65712765552737, 61.69652641474386, 55.77227006607662,
        61.40256162165512,  63.2675990742736, 68.25055392711644, 71.67802812234322,
        59.73986732927654,  55.4969110171383, 67.25466310597947, 71.06777428120115,
        72.95554227131818, 70.72682271502259, 70.78975554805866, 78.34814830539098,
        81.62390085163176, 81.74428511247477, 76.74755585164387, 78.00016508904137,
        74.20684415747593, 76.02346765940943, 80.25342760007325, 75.83720870090423,
        67.46477371935713, 63.59053126057739, 58.86558441321488, 67.38077445474208,
        61.04140835472478, 62.62591090788985, 63.56554644755416, 58.03451776898953,
        56.05876506027154, 56.39644172586873, 56.83883170661744, 62.52701300936575,
        56.73367228315432, 57.37118681263438, 62.31119640594513, 67.74809035240874,
        71.5765405015117, 71.07909764429127, 68.29201297596553, 68.64838590170534,
        68.06026994799443, 62.78777834537918, 66.10604553685405, 63.14629942510779,
        65.97968299592308, 60.05570613458776, 67.00946372690916, 70.97929252374523,
        77.74436467815053, 71.81137976613776, 75.01230984897198, 69.41765439068222,
        75.01434348888282, 76.57662177754528, 73.07477241069925, 75.07786506949381,
        71.40857851863814,  64.1871529989179,  67.2387860093619, 68.54988696615317,
        62.42396782001948, 60.68987994434104, 57.46883688175553,  56.7075324613674,
        51.22161701582099, 56.19550513596158, 55.33392160384044, 59.00919924300658,
        49.90009925384401,  48.8115935948866, 56.07097213387363, 58.44417527284165,
        57.62329215494232,  53.9369579778952, 56.50404325190912, 61.73145377381501,
        66.31762122796727, 62.10736184778062, 64.84375850185728,  58.1963562086251,
        63.00601220038295, 55.28871673598671, 55.17779383339649, 46.89367076375908,
        40.29205691307691, 41.41696844565985, 34.00544852140136, 39.96754170287133,
        48.83180174170547, 46.78412590020144, 51.32534373273101, 51.72164656603601,
        52.83552422263546, 50.72308455249135, 53.39166997039623, 46.22645305702162,
        41.39123872365555, 47.51495209470086, 41.84599882366005, 43.69882639673799,
        48.3870131329161, 42.97834919553825, 38.06787273541481, 44.82249643022983,
        44.24256729094527, 48.35107994323995, 49.72676401819153, 46.70061889369209,
        49.21250485866258, 53.90404785682435, 49.16760502038493, 43.16571907400388,
        48.66215155088751, 52.53659962146899, 50.87323480424051, 51.24887122640932,
        55.4741634601367, 63.76925777502077, 63.85526142219142, 66.48325751883532,
        60.73693191407449,
};

float UO_REF_FLOAT[data_len] = {0};

double WR_REF_DOUBLE[data_len] = {
        -75.44474246769668,-5.186714459128375,-5.187713908918398,-6.426375281269259,
        -2.938018947112311, -13.3063736504787,-32.25804077783079,-42.13703470504731,
        -39.01205423630118,-78.72983442133771,-28.59697910447765,-36.77614328358218,
        -21.25371940298512,-40.77613134328363,-74.55089363189705,-76.60497714906995,
        -78.23057208490252,-80.43482620270443,-91.15836196139546,-82.10104919311138,
        -75.1386506811216, -77.7264393657275, -81.0536182510458,-91.97831264568404,
        -80.47572450968866,-92.07857972863559,-94.03800799471537,-96.08239446133067,
        -98.47439872679979,-94.62614728905879,-89.93434399973459,-99.54232254973053,
        -86.35135401144422,-57.79280961164098,-44.72977181032947,-27.53269875554956,
        -8.175540371974241,-11.11551394580174,-4.624959910603923,-7.034583293367039,
        -9.954751489527451,-15.27145429811457,-10.93512519933556,-6.129236089993281,
        -8.061288763297082,-3.790356340509923,-7.861780640958567,-11.51701265250691,
        -28.23527065116321,-7.818672285238305,-16.23781145064374, -32.3869361537051,
        -20.71882724188477,-12.40316245198554,-0.5637842757175793,-6.584087812831092,
        -51.26646973985294,  -39.223630948654,-18.89687741860103,-34.01428946592397,
        -18.1817912526945,-6.238070654428986,-17.77043438640947,-30.46352769614299,
        -4.966855401072101,-48.33134651735279,-0.1133220982513761,-0.6667428571425998,
        -4.469240660373051,-20.49862229929613,-18.22336414347333,-10.57275213956468,
        -20.82868607273092,-43.45332743383688,-68.06946914344113,-87.89260278247359,
        -97.36021471071561,-84.64745024425676,-77.56167915705986,-62.31332532800548,
        -70.788450695351,-72.55993080651322,-43.07050022554712,-64.67523281440187,
        -68.18337885667428,-51.64987362101824,-38.27715067523631,  -30.137520251967,
        -4.793523414721772,-9.057616651418133,-57.22602260572813,-38.55479596382055,
        -67.23343768034657,-58.27337042596701,-35.51343465614922,-38.59170925072191,
        -59.17401918103744,-35.54501407040919, -8.63097341800983,-8.779812681575418,
        -14.70209654117921,-0.5069835555756843,-0.5284498591302805,-13.09993022029341,
        -33.20346748187043,  -28.225136537932,-24.76191873840989,-16.44141663622744,
        -24.5945573776429,-39.14415844290427,-40.31413941503952,-56.93817670642284,
        -35.11402058802505,-42.54073504017043,-51.66550407814653,-26.06381450881775,
        -32.41076761002689,-82.67854000318044,-56.53167502877771,-9.243746140182123,
        -19.391873831249,-37.36488840396363,-19.59456994154316,-2.286127162532949,
        -6.352698272598385,-9.826130434782707,-12.21738260869568,-16.34786956521749,
        -12.39133043478264,-7.478265217391413,-1.856187161639572,-8.274808503822266,
        -0.3101394387164551,-5.959945971668476,-0.6696162507900335,-0.8470859446384442,
        -28.77509070491186,-37.21332715443496,-5.981902238930084,-0.4838804195125778,
        -1.419902118494186,-4.296704847726417,-3.974944109853749,-3.984463238237448,
        -1.294162680796376,-1.070959681643905,-3.251145886563148,-1.126446057202429,
        -8.110026028230905,-0.07008764795388092,-1.093758773202493,-5.562754462792061,
        -25.53078036746931,-47.42666372657788, -49.2478110657915,-12.90581436824436,
        -33.27347978841966,-1.435014225119897,-7.716048588883869,-52.10182004956405,
        -73.57855035175179,-54.43156269933665,-22.32454021077426,-1.971510383656915,
        -27.7361624490458,-17.13113896534681,-2.228339411547469,-6.760957244654588,
        -0.7890276996097287,-3.796016326530625,-5.337464943065081,-8.434225947418614,
        -7.340906291042276,-12.17751831042393,-1.060670028651244,-2.797950758492622,
        -0.2792460329188403,-14.34966768922942,-8.715797244654762,-1.200777005803573,
        -0.7512019456490963,-10.68423192130042,-3.387037126807276,-11.23536011376183,
        -4.829983797529555,-2.510160418914535,-6.860231518514335,-0.299771019148368,
        -14.11259696033411,-18.95348934491775,-7.202524166456111,-0.02977029616563149,
        -8.305023728813675,-8.406677094962092,-2.789938615983294, -16.4159291500026,
        -54.94835437990159,-21.55135140897885,-15.28084391463465,-17.32699532751429,
        -79.84325294543943,-74.87318867085669,-35.11509264239319,-24.97070913564003,
        -10.30048570025643,-30.51114114101826,-24.58063507986061,-32.14990008780731,
        -2.53606661411105,-11.62704026003894,-11.31483977470935,-34.52986450841509,
        -14.40002400000003,-27.68005200000016,-56.68005200000016, -76.4412099081889,
        -95.25436313013992,-84.13241753540204,-98.96793605456394,-76.01977620157156,
        -40.09880112077904, -53.4932826964052,-33.61490190852675, -47.4931624782273,
        -52.16753884252404,-85.64730793273742,-57.57176124153139,-70.25594109939139,
        -99.59060870655502,-46.48214107142853,-96.54686406250002,-77.95730841853884,
        -85.72069036179049,-88.54664559310362,-98.36841447368421, -87.0470372213819,
        -60.58200008702553,-57.92098136394466,-37.92496223858917,-52.41771160208979,
        -38.49293543215276,-38.07757455161349,-57.95573027085482,-35.20449252705327,
        -42.26140867833793,-1.267295451024242,-20.76496313395506,-9.527845577825394,
        -6.278594194203209,-1.142162175648272,-2.336926698703823, -7.43915589805379,
        -3.291142750791485,
};

float WR_REF_FLOAT[data_len] = {0};

TEST(momentum_backend, RSIDouble_SelfAllocated) {
    int window_size = 14;

    double* out = _RSI_DOUBLE(SAMPLE_CLOSE_DOUBLE, nullptr, data_len, window_size, 0);
    for (int i=0; i<data_len; i++) {
        ASSERT_DOUBLE_EQ(RSI_REF_DOUBLE[i], out[i]);
    }

    free(out);
}

TEST(momentum_backend, RSIDouble_PreAllocated) {
    int window_size = 14;
    double* out = (double*)malloc(data_len*sizeof(double));

    _RSI_DOUBLE(SAMPLE_CLOSE_DOUBLE, out, data_len, window_size, 0);
    for (int i=0; i<data_len; i++) {
        ASSERT_DOUBLE_EQ(RSI_REF_DOUBLE[i], out[i]);
    }

    free(out);
}

TEST(momentum_backend, RSIFloat_SelfAllocated) {
    int window_size = 14;

    float* out = _RSI_FLOAT(SAMPLE_CLOSE_FLOAT, nullptr, data_len, window_size, 0);
    double max_fp_error = get_max_fp_error(RSI_REF_DOUBLE, data_len);
    for (int i=0; i<data_len; i++) {
        // keeping this since it's nice for debugging.
        //printf("%d %f %f %f\n", i, RSI_REF_FLOAT[i], out[i], out[i] - RSI_REF_FLOAT[i]);
        ASSERT_NEAR(RSI_REF_FLOAT[i], out[i], max_fp_error);
    }

    free(out);
}

TEST(momentum_backend, RSIFloat_PreAllocated) {
    int window_size = 14;
    float* out = (float*)malloc(data_len*sizeof(float));
    double max_fp_error = get_max_fp_error(RSI_REF_DOUBLE, data_len);
    _RSI_FLOAT(SAMPLE_CLOSE_FLOAT, out, data_len, window_size, 0);
    for (int i=0; i<data_len; i++) {
        ASSERT_NEAR(RSI_REF_FLOAT[i], out[i], max_fp_error);
    }

    free(out);
}

TEST(momentum_backend, AODouble) {
    double* out =  _AO_DOUBLE(SAMPLE_HIGH_DOUBLE, SAMPLE_LOW_DOUBLE, 5, 34, data_len);
    for (int i=0; i<data_len; i++) {
        ASSERT_DOUBLE_EQ(AO_REF_DOUBLE[i], out[i]);
    }

    free(out);
}

TEST(momentum_backend, AOFloat) {
    float* out = _AO_FLOAT(SAMPLE_HIGH_FLOAT, SAMPLE_LOW_FLOAT, 5, 34, data_len);
    double max_fp_error = get_max_fp_error(AO_REF_DOUBLE, data_len);
    for (int i=0; i<data_len; i++) {
        ASSERT_NEAR(AO_REF_FLOAT[i], out[i], max_fp_error);
    }

    free(out);
}

TEST(momentum_backend, KAMADouble) {
    double* out =  _KAMA_DOUBLE(SAMPLE_CLOSE_DOUBLE, 10, 2, 30, data_len);
    for (int i=0; i<data_len; i++) {
        ASSERT_DOUBLE_EQ(KAMA_REF_DOUBLE[i], out[i]);
    }

    free(out);
}

TEST(momentum_backend, KAMAFloat) {
    float* out = _KAMA_FLOAT(SAMPLE_CLOSE_FLOAT, 10, 2, 30, data_len);
    double max_fp_error = get_max_fp_error(KAMA_REF_DOUBLE, data_len);
    for (int i=0; i<data_len; i++) {
        ASSERT_NEAR(KAMA_REF_FLOAT[i], out[i], max_fp_error);
    }

    free(out);
}

TEST(momentum_backend, ROCDouble) {
    double* out = _ROC_DOUBLE(SAMPLE_CLOSE_DOUBLE, 12, data_len);
    for (int i=12; i<data_len; i++) {
        ASSERT_DOUBLE_EQ(ROC_REF_DOUBLE[i], out[i]);
    }

    free(out);
}

TEST(momentum_backend, ROCFloat) {
    float* out =  _ROC_FLOAT(SAMPLE_CLOSE_FLOAT, 12, data_len);
    double max_fp_error = get_max_fp_error(ROC_REF_DOUBLE, data_len);
    for (int i=12; i<data_len; i++) {
        ASSERT_NEAR(ROC_REF_FLOAT[i], out[i], max_fp_error);
    }

    free(out);
}

TEST(momentum_backend, STOCHDouble) {
    double* out = _STOCHASTIC_OSCILLATOR_DOUBLE(SAMPLE_HIGH_DOUBLE, SAMPLE_LOW_DOUBLE, SAMPLE_CLOSE_DOUBLE, 14, 3, data_len);
    for (int i=0; i<data_len; i++) {
        ASSERT_DOUBLE_EQ(STOCH_REF_DOUBLE[i], out[i]);
        ASSERT_DOUBLE_EQ(STOCH_SIGNAL_REF_DOUBLE[i], out[i+data_len]);
    }

    free(out);
}

TEST(momentum_backend, STOCHFloat) {
    float* out =  _STOCHASTIC_OSCILLATOR_FLOAT(SAMPLE_HIGH_FLOAT, SAMPLE_LOW_FLOAT, SAMPLE_CLOSE_FLOAT, 14, 3, data_len);
    double max_fp_error1 = get_max_fp_error(STOCH_REF_DOUBLE, data_len);
    double max_fp_error2 = get_max_fp_error(STOCH_SIGNAL_REF_DOUBLE, data_len);
    for (int i=0; i<data_len; i++) {
        ASSERT_NEAR(STOCH_REF_FLOAT[i], out[i], max_fp_error1);
        ASSERT_NEAR(STOCH_SIGNAL_REF_FLOAT[i], out[i+data_len], max_fp_error2);
    }

    free(out);
}

TEST(momentum_backend, TSIDouble) {
    double* out = _TSI_DOUBLE(SAMPLE_CLOSE_DOUBLE, 25, 13, data_len);
    for (int i=1; i<data_len; i++) {
        ASSERT_DOUBLE_EQ(TSI_REF_DOUBLE[i], out[i]);
    }

    free(out);
}

TEST(momentum_backend, TSIFloat) {
    float* out =  _TSI_FLOAT(SAMPLE_CLOSE_FLOAT, 25, 13, data_len);
    double max_fp_error = get_max_fp_error(TSI_REF_DOUBLE, data_len);
    for (int i=1; i<data_len; i++) {
        ASSERT_NEAR(TSI_REF_FLOAT[i], out[i], max_fp_error);
    }

    free(out);
}

TEST(momentum_backend, UODouble) {
    double* out = _ULTIMATE_OSCILLATOR_DOUBLE(SAMPLE_HIGH_DOUBLE, SAMPLE_LOW_DOUBLE, SAMPLE_CLOSE_DOUBLE, 7, 14, 28, 4, 2, 1, data_len);
    for (int i=28; i<data_len; i++) {
        ASSERT_DOUBLE_EQ(UO_REF_DOUBLE[i], out[i]);
    }

    free(out);
}

TEST(momentum_backend, UOFloat) {
    float* out =  _ULTIMATE_OSCILLATOR_FLOAT(SAMPLE_HIGH_FLOAT, SAMPLE_LOW_FLOAT, SAMPLE_CLOSE_FLOAT, 7, 14, 28, 4, 2, 1, data_len);
    double max_fp_error = get_max_fp_error(UO_REF_DOUBLE, data_len);
    for (int i=28; i<data_len; i++) {
        ASSERT_NEAR(UO_REF_FLOAT[i], out[i], max_fp_error);
    }

    free(out);
}

TEST(momentum_backend, WRDouble) {
    double* out = _WILLIAMS_R_DOUBLE(SAMPLE_HIGH_DOUBLE, SAMPLE_LOW_DOUBLE, SAMPLE_CLOSE_DOUBLE, 14, data_len);
    for (int i=0; i<data_len; i++) {
        ASSERT_DOUBLE_EQ(WR_REF_DOUBLE[i], out[i]);
    }

    free(out);
}

TEST(momentum_backend, WRFloat) {
    float* out =  _WILLIAMS_R_FLOAT(SAMPLE_HIGH_FLOAT, SAMPLE_LOW_FLOAT, SAMPLE_CLOSE_FLOAT, 14, data_len);
    double max_fp_error = get_max_fp_error(WR_REF_DOUBLE, data_len);
    for (int i=0; i<data_len; i++) {
        ASSERT_NEAR(WR_REF_FLOAT[i], out[i], max_fp_error);
    }

    free(out);
}

int main(int argc, char* argv[]) {
    populate_float_arrays();
    for (int i=0; i<data_len; i++) {
        RSI_REF_FLOAT[i] = (float)RSI_REF_DOUBLE[i];
    }
    for (int i=0; i<data_len; i++) {
        AO_REF_FLOAT[i] = (float)AO_REF_DOUBLE[i];
    }
    for (int i=0; i<data_len; i++) {
        KAMA_REF_FLOAT[i] = (float)KAMA_REF_DOUBLE[i];
    }
    for (int i=0; i<data_len; i++) {
        ROC_REF_FLOAT[i] = (float)ROC_REF_DOUBLE[i];
    }
    for (int i=0; i<data_len; i++) {
        STOCH_REF_FLOAT[i] = (float)STOCH_REF_DOUBLE[i];
    }
    for (int i=0; i<data_len; i++) {
        STOCH_SIGNAL_REF_FLOAT[i] = (float)STOCH_SIGNAL_REF_DOUBLE[i];
    }
    for (int i=0; i<data_len; i++) {
        TSI_REF_FLOAT[i] = (float)TSI_REF_DOUBLE[i];
    }
    for (int i=0; i<data_len; i++) {
        UO_REF_FLOAT[i] = (float)UO_REF_DOUBLE[i];
    }
    for (int i=0; i<data_len; i++) {
        WR_REF_FLOAT[i] = (float)WR_REF_DOUBLE[i];
    }
    testing::InitGoogleTest(&argc, argv);
    return RUN_ALL_TESTS();
}
