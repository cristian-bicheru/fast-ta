#include <cstdlib>

#include "gtest/gtest.h"
#include "testing_common.h"

extern "C" {
    #include "volume_backend.h"
}

const double ADI_REF_DOUBLE[data_len] = {
        -13076765.60693842, 12799974.04091093, 28386380.57297606, 41694930.63016835,
        61746609.34287685, 46904600.93122686, 30609117.72880282, 40192737.59755313,
        33773369.35110775, 21082023.12627682,-16236162.36408982,-33791774.99042606,
        -15235067.45055062, 12833678.71098193,-2048285.325506005,-11512965.98698881,
        10044219.60505136, 28615076.81713767, 20905678.46208723, 39724099.07673612,
        58578687.56901424, 48114272.56677595, 50814576.52097984, 65519357.87396045,
        69817179.86745577,   44398991.478074, 57378659.94079952, 38380026.90447353,
        17105876.9870113, 12089828.03808418, 17891838.28215479,-7709400.326378409,
        -16105437.94622484, 12646360.50190996, 4526215.774551369, 23660007.86718853,
        36682110.72101243, 23886409.41237269, 24110738.58611237, 17189313.28768239,
        2988580.676358055, 12055770.59940636, 15473255.02913398, 22790448.55958852,
        10872051.21102067, 13207018.85678189, -12286556.5796233,-22999002.45124349,
        -41097022.3444829,-32073690.28793558,-49420483.08733574,-58436307.91250924,
        -72948213.42087872,-63667496.02860186,-52695024.34403051,-48893491.99277312,
        -46944277.65225675,-30481729.79535183, -20832148.9174893,-40421312.29961865,
        -36511186.39605061,-31526471.46333693,-35468525.45749255,-48335769.22010238,
        -33504108.28436309,-52107980.49875249,-29953101.44795274,-13184323.81372621,
        -5461332.471117435,-16156684.81160704,-25612296.81289501, -22854008.0975012,
        -21782404.29835113,-67121591.99351503,-104967720.2839464,-105137894.3300066,
        -144411151.9507743,-127610001.3840518,-100290786.7587326,-74586171.81042355,
        -75082666.44258818, -76942691.1440632,-55398721.51305193,-88908344.33057505,
        -95528468.90528715,-78889713.81794988,-97516253.39143822,-123690843.1280354,
        -123375710.0983788,-125003956.3582996,-157924860.9128053,-148999014.5594651,
        -168378172.9745184,-154963049.1817088,-138865255.6079797,-139971113.9789335,
        -138520191.085595,-124484370.9086868, -113985679.512243,-118142008.6315689,
        -113921064.8545636,-83146044.36829861,-40634113.06676722,-68696775.92488192,
        -71966415.09626952,-54595538.81908458,-38863205.48826118,-14712207.42491591,
        -29093740.3292227,-78845882.59800982,-79283345.67521261,-104706899.3990124,
        -87525801.02389726,-87436596.28503489,-91570010.44717795,-73954722.50411516,
        -102007182.3610702,-123999625.0928076,-96767021.70553586,-71379418.65037413,
        -83714638.20298018,-110620507.6623578,-105143073.6994723,-83188312.34260531,
        -63864302.48195055,-71249728.98244621,-86151330.54115283,-83434420.46511406,
        -77716639.40891221,-70682981.85381162,-54576842.79313631,-69727609.10463528,
        -51896802.40524261,-48711057.91438054,-31773078.03133658, -11446929.0028191,
        -39995087.18457493,-39919125.64573714, -7523958.27017051, 29029743.26200325,
        47530778.68749511, 44860407.89741278, 59353360.55508387, 63591678.55500488,
        78164179.17205304, 95983343.91880012, 98436310.72300744, 119827791.1535859,
        106193877.4789047, 130883919.0522115, 148089236.2716207, 142179700.0579642,
        141712226.039563, 129165453.3274556, 125955085.5285649, 146209930.8555832,
        140114295.7931668, 154712724.2460245, 158042576.6018749, 141408831.1660113,
        168603935.3859633, 165346968.6693976, 180302179.6383712, 202663947.3533409,
        192501146.6327275,   198031742.70871, 212722669.0767262, 232637801.4624879,
        263742097.1832611, 280143437.2036496, 282546057.5150909, 266477276.5321114,
        265484455.9690212, 226179684.7501736, 247647044.5125966, 252137788.6920443,
        274800746.1652372, 259236434.5508555, 283978843.1910954, 308816773.9258732,
        339556552.7652973, 319652275.9671853, 347935460.7933521, 335202029.2090433,
        356882609.0609058, 383323977.3875003, 381255367.3434126, 410509107.6178008,
        377668062.8661962, 365526976.2471439, 385800259.0236186, 420070498.9256507,
        402820233.6995186, 384771868.8132058, 406481382.0362099, 379809638.0335442,
        387154715.2572361, 418439061.4315951, 413843615.1420658, 442918586.3377749,
        401482164.528536, 407696007.6333342,  432871072.195157, 428729527.2950382,
        454979545.0197476, 447678792.0344662, 475015992.0344662, 459613444.9237998,
        487848361.7093996, 489251280.6422549, 496098083.8258923,  523102667.273995,
        536829981.1638866, 528007001.3805696, 512219543.9397142, 523180624.7036644,
        479225929.9609714, 483228719.2626545, 409961459.2501653, 467776682.1516259,
        534199423.0509582,   485225013.17647, 532976829.5515994,  503481490.294028,
        538917324.7944803, 497349911.5616338, 559480244.5127274, 544324572.3429365,
        441893512.0271183, 521174001.4616076, 459241028.5701323, 500190959.4327757,
        536438097.7730482, 497307124.6850163, 407334968.9288564, 447760084.1179636,
        510946116.8737541, 448321416.9904853, 508887912.6682419,  465821815.176362,
        498072119.6712568, 470324652.6096106, 442623999.7740096, 481895036.3840702,
        472969447.8250279, 518720905.6174794, 471433751.0252793, 495777884.4611965,
        504909853.9258048, 533919579.0227008, 571197895.4615048, 582108362.1281717,
        596852362.8429149
};

float ADI_REF_FLOAT[data_len] = {0};

const double CMF_REF_DOUBLE[data_len] = {
        -0.5088948493539337,0.2344180202059757,0.3602378275482692,0.4244255625866473,
        0.5079454378473188,0.3371954911624401,0.1941644801894051,0.2279864680758614,
        0.170143690077727,0.08603713413761691,-0.05239816125501902,-0.0988475171838393,
        -0.04199880758249654,0.03247445036611705,-0.004720021268259895,-0.0250120758889194,
        0.02028295682262304,0.05334517397981273,0.03520397852178606,0.06301672559212258,
        0.1135185885033078,0.0555827125057764,0.03482476354444269,0.03592328568495721,
        0.01207726828896498,-0.003682268368033321,0.03832766289749587,-0.002576685607659825,
        -0.02350022180398099,-0.01300964314274539,0.05270036173782808,0.0405867340520136,
        -0.001314487621172811,-0.0002835312496926891,0.01008867676090289,0.05429116939986911,
        0.04138671240896583,-0.007521986384334499,0.005358302595183976,-0.03886376648242703,
        -0.09668342386435229,-0.06430973749331342,-0.06514643388565489,-0.0805553489784724,
        -0.1126651625368655,-0.06057234747432218,-0.1323867732606777,-0.1178709861792586,
        -0.1132676724895952,-0.08635148732501775,-0.1316956524119479,-0.09846303972580621,
        -0.1132082874510716,-0.1563567912612461,-0.121834495871369,-0.1562296442592448,
        -0.1821699051670679,-0.1199083293106492,-0.1011365257708334,-0.1290709803984983,
        -0.08931163403360552,-0.09894825114385901,-0.1150829803928104,-0.1653294125570355,
        -0.1037633231440618,-0.1529330156324269,-0.04399481538692614,0.0244331914863591,
        0.0900765082521109,0.04150913431781827,0.06262393572479961,0.09597645091614913,
        0.1355892470603651,-0.008038294087999349,-0.1106625990289543,-0.1134056668094882,
        -0.1863568604516102,-0.1804490174404951,-0.1434980901952126,-0.06094949138819287,
        -0.06795918666799673,-0.07924716893881666,-0.03302722449850135,-0.06482408035450574,
        -0.09774810722242491,-0.04176659926823882,-0.1050161883754018,-0.1695175161309168,
        -0.1790835255610355,-0.1632440373514908,-0.1901109508882285,-0.1801181994291733,
        -0.2117569045449562,-0.1374798274522093,-0.05594453088260872,-0.05942262117209376,
        0.01063687106925053,0.005818504987481884,-0.02595021301039677,-0.08374673002969746,
        -0.07429209361414646,-0.01165862604485241,0.02790230070403863,0.03851046819587624,
        0.0438470656271903,0.04575978227222464,0.1117601545986143,0.2082656303002182,
        0.1799986326062889,0.08287620023389763,0.1485765627587715,0.08287469428285987,
        0.1524145008964972,0.1266030154149075,0.08795301081670769,0.1216741514087721,
        0.06551182430377175,0.0008463123871684315,0.02981756669812086,0.07889433583403739,
        0.05068265523895706,-0.04639636065420449,-0.1138584638173738,-0.02575823459393125,
        0.01435186451957155,-0.02934749041355927,-0.0828157654490481,-0.1218177218164192,
        -0.08698575837092216,0.01546236157096729,0.04656622609788442,0.06727438639125216,
        0.06891443773610498,0.07512393263063633, 0.117593366481106,0.1233693951415808,
        0.1221730487528964,0.1667952460603494,0.1748910318419805,0.1955617415489635,
        0.2580111411439527,0.3105267210779667,0.3283531708616397,0.2956557077137786,
        0.3007462764256984,0.3568766428417092,0.3939053707325791,0.4271857759123308,
        0.3821784858239776,0.4182671246489706,0.4206667221521253,0.4412511885418565,
        0.3968672490629789,0.3551327476266674,0.3161928667836887,0.3180507371403394,
        0.3703750422130323,0.4128212625676962,0.3692948964595291,0.2588354106299071,
        0.2770796259865127,0.2777579385894797,0.2790551740571151,0.3188221649162781,
        0.253676042754387,0.2253369702619204,0.2535683710219487,0.2455828620771899,
        0.3348830727380553,0.3126166072536212, 0.277622034955002,0.2514712802750564,
        0.2514085591310489,0.1827144893233514,0.2256594930837967,0.1997180131953834,
        0.255394883381773, 0.190867971611919,0.2201693374937619,0.2918666054366239,
        0.2953368712968296,0.2577663556110996,0.2749820315480563, 0.217163580179895,
        0.2688943066139567,0.2935342524769523,0.2605970089680344,0.2767248756292276,
        0.1753071803287933,0.1317039093114638,0.1595973480382504,0.2354229767231193,
        0.2095026542250202,0.2591392493791337,0.2589109143278386, 0.200117101906046,
        0.1714829293774741, 0.241515287545207,0.1917640923944844,0.1961425991715637,
        0.08850024368694567,0.1245952053910318,0.1194265309634341,0.1310488561831621,
        0.1387468882935861,0.09274167941242059, 0.136659226966717,0.0722878972719236,
        0.1651302939278342,0.1873366019623495,0.1688422562826077,0.1568369028694849,
        0.2053085992221334,0.2195487702036322,0.1605310306737478,0.2115890225798489,
        0.132519431758266,0.0920660210658225,-0.005319300587881274,0.03088499726952629,
        0.1579380548279886,0.08843431895933382,0.1115601885609157,0.08173976469952925,
        0.0888513105594573,0.0503271541118777,0.08192857138670012,0.07907551066467811,
        -0.04004938032175141,0.02624250879637125,-0.02886158063667017,-0.01735854453749986,
        -0.0002857392782442343,-0.02170684560689733,-0.07075658617794328,-0.04991534940639783,
        0.02079762275969249,-0.02249805037630528,0.06447070017904034,-0.001321951587084589,
        -0.02516848460110977,-0.01060674945012405,-0.06481273134503736,-0.01554491830264935,
        -0.04832847490315843,0.01590879159614619,-0.06656350750768589,-0.03731294343405323,
        0.05094374843312737,0.01082839321665534,0.09776232479950366,0.07468002686760791,
        0.05726237768398287
};

float CMF_REF_FLOAT[data_len] = {0};

const double EMV_REF_DOUBLE[data_len] = {
        -1,  16.9964683916105, 15.76376924937368, 4.079332441678085,
        36.06849637691569, 15.81582155104432,-18.86412205013137,-44.47617954747166,
        12.87591088823537,-33.74110483739194, 103.3071236809168,-26.55797082796284,
        4.970440758362081,-80.07579380517888,-34.76584701668857,-7.905255832464293,
        -62.91415114042297,-49.57391812890733,-111.3453108098466, 16.32394496807655,
        28.70969826366049, 19.45147994024637,-22.97968841907475,-68.67258113332812,
        46.94374331914216,-23.58157472947977,-37.03055639644564, 17.88599518444649,
        -10.83569932955982,-18.52537603746331, 3.317800069807255, -16.1959798251712,
        -45.35528486654896, 52.81194930249309, 76.16372832795045, 10.98001125337297,
        100.9152576389921, 66.50220816219112, 11.62894218577289, -1.69910755252496,
        7.579571064778412,-56.99159049116559, 30.81186269114662, 80.07129189120985,
        10.2804355668407, 8.694327321729698,    1.016728158224,-3.658811112785772,
        -35.61093847744919,     26.4614557015, 13.39733584692605,-18.07344310294079,
        60.37639819223401,-3.396742317693299, 20.33091225136413, 5.366161883339917,
        -48.20355568188511, 3.345769681249784,  30.1302787323027, 5.375513029804366,
        0.5114579543653379, 20.24758343465664,-2.011598524895116,-8.063058018756024,
        7.156348871543916,-7.121125455698696,  16.0867398184301, 23.65340328626168,
        0.7924091491899511,-3.157821072923835, 6.615003660892537,  11.2165294092803,
        -6.760589600323334, 110.4653183394325,-82.55678660225219,-98.14452546482873,
        -97.49200990588783, 4.949683515408231, 10.92454422971015, 73.11422095929223,
        -6.131139778348076,-5.483854321752213, 141.0011022586424,-18.90901950615102,
        -42.39003667261861,   37.202320531245, 65.02922801228611, 5.128185651071655,
        7.52007018712421,-0.4974290567321986,-143.2643698684234,-3.271455539963746,
        -1.649172390054264,-22.88744246755108, 43.97329458566755, 12.83484385198219,
        -44.4537768316811, 31.51940880007398, 44.64561080041565, 7.151781090032869,
        5.702584128395344, 7.817660937356061, 87.42585675865988, 43.30316513948341,
        -54.37398476733317,-0.728764444723073, 10.44022037586712, 15.81201629839002,
        14.13728316546263,-18.83033243946583,-14.51207844830014, 18.60660302084392,
        -10.35098642221759, 6.329971991398166, -11.1044589775637, 52.01198441703379,
        40.71309991439902,  -89.045823507867,-55.22960119197717, 79.49818014013995,
        29.3608252743856,-22.54935691297458, 5.980913730695535, 23.95010248321801,
        78.03475579690566,  20.4527349224539,-1.712243841474528,-22.57987908500841,
        9.572738351118042, 14.85731807091839, 54.17904416409007,   22.008407506683,
        14.06547074477278, 18.55929914305542, 31.43825023272516, 33.32365560489094,
        -36.69420996704266,-38.16653200239693,-1.369630660742121, 167.1832650278792,
        38.93764567358817, 5.991643954286438,-9.221829026210044, 26.42527530982825,
        -12.00300141189714, 35.43671664552563, 12.66805196984512, 15.45601769247239,
        7.044884820829219, 10.00669528098423, 21.18475982452816, 11.85629184172365,
        -73.89121555684815,-6.014504147817591,-8.382153441422709, 46.09564358185789,
        6.201193411982783, 29.71432941542622, 5.495658978196535, -22.3519951913399,
        -89.92549909807178, 63.96720572274302, 39.31756015537951, 67.52915007700902,
        -23.82809912976249, 2.048663443204481, 24.23170677347003, 2.137044593867441,
        41.54481908518397, 68.59957485204626,  14.5690112859978,  2.15642534067182,
        -4.035099218666143, 3.201083064629996, 26.84500403768776, 25.92626628574145,
        77.90614109355319, 59.27336019285175,-43.33300751346635, 43.66093510661436,
        100.5489960468133, 7.193817436890976, -53.2281054540304, 35.62229313278371,
        35.49627926274252, 74.74834893517196, 26.96422637751794,  71.1187569691008,
        10.13630192188202,-45.77579185716944, 18.17805522841284, 32.29350524346914,
        6.974867019376809, 12.00085450211891,-15.64417780837689, 44.72339626148037,
        -205.9250201065685, 106.7190612325204,  111.549148486898,-53.84534166715095,
        -171.1612736412487,-197.6947012969799, 154.4996792336649, 102.0921050470035,
        16.6546446216092,-37.44275741799832,-84.50004389622907, 79.34394702464131,
        61.4788970231354, 5.331237836050657,-5.782220247124321,-97.52258099389476,
        99.29322440022486,-21.90113320618472,-182.9420539229612,-505.1616271457317,
        -67.54129774712132,-49.18478120196496, -206.781922299627,-249.6819944396824,
        616.697347992309, 121.2285724980691,  63.0692978321577,-48.34364882316324,
        -160.3582463100593,-325.8553306912009, 176.1509482351355,-19.99457481034892,
        -368.8447511673362,  216.352733306086,-399.9168792667167,-36.39792261209703,
        -76.27596536158492, 62.69164753406596,-185.3277636215851,-365.4079652314688,
        380.7470025374606, 188.9394077904665, 24.33814108774458,-18.31225223393237,
        14.57349961065961, 101.9168540218683,-289.9553508601416,-57.67371183723672,
        27.15222793341524, 378.5226208650469, 227.9764301742683,-15.26864379793399,
        40.87549311474344, 57.18266072698845, 280.0630673637115, 5.746791948905992,
        31.35556021580375
};

float EMV_REF_FLOAT[data_len] = {0};

const double EMV_SMA_REF_DOUBLE[data_len] = {
        -1,  16.9964683916105, 16.38011882049209, 12.27985669422075,
        18.22701661489449, 17.74477760212445, 11.64329432674848, 3.626226630431321,
        4.782437162656827,0.5020436070958536, 10.78255161447795, 7.387958665165154,
        7.186498839598232,0.4740147899999928,-2.043118196192047,-3.821812783625961,
        -9.441664240040009,-13.27403928079611,-23.80359693699341, -23.7673024072054,
        -20.36917238479169,-15.80291099281184,-18.36402522904827,  -20.859130678758,
        -24.88508641888476,-24.67248669756455,-27.67255792290796,-20.67528728079186,
        -18.96599101742552,-19.72457103206831,-14.99371737419472,-12.60957892392785,
        -7.89600564226374,-5.289719618376844,-1.900146042356132,-2.505250948561375,
        6.344388055586255, 15.99973014812334, 13.47724435288268, 15.04027772266517,
        18.22671539846689, 12.87831642163745, 15.85314228025934, 22.89576141802171,
        23.39309252495267, 25.17097160687416,  28.4832582515008, 24.44963250755231,
        16.46572773573805, 17.57154519631856, 11.32026506831384, 5.279147120804418,
        8.76110826412307, 8.639848638039618, 9.550658722795742, 14.00478389240328,
        8.360825437186724, 2.880430993618148, 4.298276934008291, 4.061218770299338,
        4.025128041452291, 5.732727651983891, 8.132680505737753, 5.666643811433751,
        5.220859027477884,  6.00316743085232,  2.83962040415204, 4.771773661577396,
        3.376166297136383, 2.767310371688971, 6.682921753315946, 7.245118876746697,
        4.610056852987696, 12.11647151796113, 6.183025478202739,-2.273553728903358,
        -9.09358311325998,-8.164101575105391,-7.894944763807803,-2.163848591308451,
        -3.750839991078322,-5.832072677365027, 4.182833973310147, 3.057748370936776,
        -0.4426116528854487, 1.413516284397744, 6.541360399584133,-0.9827205067273559,
        5.451340692513815, 12.42613329309214, 9.156679010053884,  8.56945479181303,
        7.671332176115571,0.8140705027696212,  4.39295867162788, 5.701437112608909,
        -7.54533996527134,-3.943309371969554, 2.273522590390037, 0.127055487446313,
        -4.110561932831599,-3.918456555239856, 1.789099628441263, 4.917713499599522,
        11.26702672110597, 11.44864751362316, 12.31217556833183,  15.0764226230419,
        12.94527895017012, 10.68348064363812, 12.82217338530819, 11.89983011536319,
        7.971501742317956, 7.912801092415478, 6.712298013418404, 9.869035404823956,
        6.532409915948179,-2.921089273148279,-2.982204732051422, 2.748291309724509,
        4.099763088190114, 1.359665001664071,0.7770671848949934, 3.832812536515267,
        10.44330069688711, 10.57516726128783, 11.19222030276947, 9.127230940169001,
        10.60417360650341, 7.950268867495168, 8.912122028187385, 16.84456710065524,
        21.79421509613738, 17.44143788205992, 17.58982537908417, 21.58075484464599,
        18.53253172337898, 14.09562926012077, 8.423887370288785, 18.90463952067631,
        21.8082030574665, 23.84902613170184, 22.50655703332126,  23.3328396932434,
        18.60555072353003, 19.56471566201879, 19.46490003523824, 19.24323707448232,
        17.50085383077546, 15.83535666478213, 19.96956879275147, 23.54262763876008,
        18.36251443189537, 5.991245205059879, 2.611259553987674, 5.475830955957063,
        6.577475415827979,  6.81240785194212,  8.06231216552024, 3.934547034315558,
        -3.393563756249935,0.07152110305510995,  2.37671219838013, 6.485458969524758,
        3.270254758503996, 2.569709872895484, 9.578490039346784, 10.16074352089572,
        13.72695584422476, 15.33437950638107, 15.93208078309643, 13.96365906347112,
        13.28289062083807, 15.10811049626449, 23.44886072024731, 20.73165076046149,
        23.48797797033103, 22.89827869289123,  21.5050709511981, 24.47737607001309,
        29.92861101810903,   30.289809078325, 23.52031446838112, 21.16479434557665,
        22.65959920105842, 27.84473660066557, 30.05897414325014, 34.91023656499806,
        33.71675784244051, 28.59518226080401, 24.32889041329399, 22.40175791690952,
        25.99517752639832, 23.73374319750578, 15.43423077927791,  18.1149149810343,
        7.207992505853007, 12.28633308440563, 17.71868088613102, 8.533417271679387,
        -5.618404158232515,-24.81936546295256,-14.50769565496807,-3.945703018955723,
        -4.05451806229884,-9.035679680975088,-15.56960188923265,-10.75938099476676,
        -5.250589935373028,-8.064315537189435, 6.231598738485149, -8.35708999197308,
        -9.232513141021164,-6.950783965237861,-7.792268271074464, -29.7541915459853,
        -45.61426133032717,-56.41975320525349,-72.37950798534179,-87.53945348689065,
        -37.45392549485221,-34.46216653246452,-34.34856647467721,-38.18248695033534,
        -49.22363166911641,-65.53311379035256,-60.04327637357323,-59.90709363101353,
        -73.18585771989747,-21.64911768762477,-45.39023065331016,-44.47688361117674,
        -35.15502954417374,-12.84262654604885,-70.13013451846986,-104.8898872134369,
        -82.1986225916295, -65.2498328335131,-52.05723373366997,-30.08987098672221,
        -41.63111731704191,-32.92315811474068,-27.28820094994106, -46.8615184601784,
        -16.35658223159754, 13.28059944534131, 35.01291341218796, 29.44432117418797,
        45.6016966553543, 75.78674136667267, 68.59503171140489, 55.50984486557913,
        56.01108908901193
};

float EMV_SMA_REF_FLOAT[data_len] = {0};

const double FI_REF_DOUBLE[data_len] = {
        -1, 112158528.5340003, 98659144.06011456, 86425612.92595533,
        83908065.36953314, 71119362.93457124, 55979266.98448968, 45371365.50047687,
        39873086.51335163, 7984410.496486995, 98065108.13467464, 77793628.26357824,
        74440304.99083851,  48650394.7389473,  10578652.6074549, 9217901.609746983,
        -2970441.997331136,-23385968.52194097,-114067146.8124065,-82429350.46933423,
        -62083605.72631503,-57178268.31889853,-54082729.09594163,-78956460.28926417,
        -53454004.29822646,-62051983.71850841,-69469197.66607873,-61882628.59151031,
        -55996797.04143739,-51455649.41683201, -41316144.4196846,-47892512.33481538,
        -51265190.37047032,-15893449.44211749,-1288287.899014901,  7520133.83090147,
        28056382.8849441,   33150756.296695, 36994971.00693858, 30096054.70411874,
        25672738.68970178, 18226131.93067297, 18032309.79563396, 32752337.95311485,
        26323135.63861271, 27449475.99995375, 18884580.79927474,  15666208.4938355,
        4367964.759216135,  19496172.7550424, 16531870.90423632, 6081387.950173974,
        19378297.89779202, 19464743.54862173, 19410958.88396146, 16193975.02568128,
        -1358779.019587468,  2421786.63721073,  7163683.96419492, 1871188.650338504,
        5499963.526804442, 9338483.278632347, 6293621.943456321, 3076884.472248291,
        8769450.238441337,-1662345.286250201, 13310388.09599977, 15656808.68571414,
        13056044.29964064, 7912215.607920569, 8594131.323774764, 13372989.12312122,
        7099429.764703944, 48247846.69997487, 5780651.599978358,-20788214.55957567,
        -97755278.07163619,-65058965.30437395,-46041521.33957763,-22525346.14820946,
        -27889121.35040811,-25542447.05379265, 35375802.68139198,-2152864.065578278,
        -5773817.465209967, 13832865.87239147, 25284243.10227843, 21710595.31316724,
        25623462.97260042, 21390755.69502894,-47344085.76768948, -26256642.6206481,
        -31117810.0853127,-23552969.17226799,-9752994.142229704,-9175210.202768339,
        -16560191.62865858,-4627797.833064508, 10005739.18007332, 8521015.947319984,
        10853961.65887423,  20788832.1679065, 61412613.24540567, 50337475.63891915,
        18493184.41238778, 19327256.36081807, 18659793.30300122, 23487533.88542963,
        14427940.49919679,-13202468.50698838,-8605838.602061482,-12010530.44839556,
        187619.8185752612,-2906353.012649816,-6366365.037128359, 13655037.70183281,
        14787092.59742821,-15163473.24001879,-5396107.062873195, 25988412.16948012,
        22494198.53519726, 8657825.627311883, 14444083.60383879, 24731402.98040471,
        57655163.51004676, 48247763.68249722,  39639263.4535691, 31469049.85883062,
        29169999.96259771, 28935016.22394083, 37576897.29106362, 30592322.94674021,
        34942265.18280591, 30940180.99514795, 34392712.28155539, 37998571.69036175,
        3186007.006167248, 2597455.614000471, 29561783.38342897, 63443875.95373912,
        60576759.28520495, 50867161.08331848,  43898421.8583444, 45052924.47933821,
        40391502.54303271, 40640981.69889949, 34086014.77174238, 38426025.92377927,
        27107905.2403536, 34401185.45487458, 33636085.43229245,  26627530.2455935,
        11061905.08048012, 4365727.039040239,  3205426.22713438, 16520840.33462959,
        6345351.17633958, 13709784.29176247, 10768950.90973928,-1196794.579194849,
        -20274619.23062415,-11883802.69750651, 20650.28523738123, 19452280.68386056,
        -657969.3805196043, 4473727.786668934, 10275743.07965914, 12191510.16187923,
        28054817.45171072,  45609661.6131092, 41336470.27586512,  32654808.3651128,
        28973524.22833966,  19117890.3283624, 32439910.38345351, 28273092.56914588,
        42991399.51705363, 36275071.00547439, 39945664.86592104, 41907585.31464654,
        68339369.76129711, 43317157.00266904, 47149601.43314472, 34931566.21212412,
        52583429.71647777, 84196461.41145232, 75684425.08101647, 93649423.14544262,
        55515058.83569381, 41749434.06526595, 50943558.73539937, 60843840.70692809,
        43601086.48548117, 41482042.74334115, 41264681.47743518, 30554852.08820167,
        -27944274.38296995, 26687891.15959705, 74229723.94482598, 61497997.99759384,
        -49647659.93684808,-47836880.08564126, 8715580.970621735, 18504440.58056152,
        30018021.99985268, 3958226.766730756, 9328800.555883542, 1460854.370414498,
        32081332.5575268, 19613873.66683726, 17040836.35483193,-17806514.20922986,
        244616.7520887498,-11714607.92542404,-43586324.65036347,-155361189.4511684,
        -216374046.1024872,-153138045.8598607,-350303565.4165946,-302699601.6263385,
        50849026.39755288,-64694426.25636932, 49596577.56479773,-23272954.29537334,
        -51370779.3415772,-278138600.6346661,-43082927.32721379,-127391968.9517686,
        -515710671.4078735,-48267306.43317699,-453152905.5662378,-265159831.3544893,
        -293652958.4717339, -270052887.123729,-454413543.1717964,-448068376.4161113,
        -152903958.8098095,-145806929.8227654,-8657149.854313284,-85460383.70903993,
        -30837758.45899131,-30091008.14377825,-109999444.6088672,-70461921.99595755,
        -76723653.54367796, 86034619.05323346, 51716148.07785726, 84380501.65719163,
        83442598.9926357, 96135843.35897356, 178506647.8813487, 140754826.1350133,
        130746108.5553692
};

float FI_REF_FLOAT[data_len] = {0};

const double MFI_REF_DOUBLE[data_len] = {
        -1,                -1,                -1,                -1,
        -1,                -1,                -1,                -1,
        -1,                -1,                -1,                -1,
        -1,                -1, 54.48623885842599, 47.82850203868546,
        40.9434543553943, 34.65286188831367, 27.50005563029721, 29.86216996053813,
        34.5247628863701, 39.81573058372418, 34.82156427171047, 35.60896984646278,
        29.80476845149578, 30.20968645374681, 24.85325785217061, 30.15121749094757,
        31.13107415414544, 31.23552981904177, 36.81273521966641, 38.30129468096868,
        40.08445295297498,  39.0358390425221, 39.36017405097984, 37.64257063059367,
        45.57217625687907, 53.73086734261653, 53.70459388464526, 55.15245540549099,
        63.14753900145888, 57.50482592814632,  63.6848948434553, 71.42686315625544,
        71.60332929345131, 78.59167072487007, 75.72880744762597, 69.61769585079107,
        62.68845096763329, 63.27488875374102,  62.3576967195263, 53.64933286229515,
        53.84337833469438, 59.11609533476457, 57.90338070779462, 63.46517316444211,
        57.06315271736067, 56.31997925295129, 55.94231506193862, 49.46900836806803,
        60.59243510594194, 66.69351284722833, 67.49257398568849,  60.9425893553478,
        60.67641295386061, 62.84392075770595,  62.1790308828275, 62.46396533603873,
        57.18554580227998,  51.1995094745698, 59.72932692942398, 60.05277479699402,
        49.73129375411403, 64.15247716511708, 52.52315594957507, 44.87050370078434,
        41.32608647648024, 47.25356192777952, 48.83804787947044, 54.04426707607139,
        48.9562698996412, 44.56497485824131, 51.28852895321509, 49.07852393361591,
        44.83814975246981, 45.41694296172321, 51.05326727376303, 46.43131661319981,
        54.95127995127876, 57.22121257678621, 57.61756878897714,  56.7886380287167,
        49.78793956688293, 44.43557938976915, 50.14953195833752, 55.66290101346097,
        46.8529287906174,  54.6798524514481, 62.12873543995664,  61.2863632088949,
        61.66465613374102, 62.28102422679332, 64.85014607173414, 71.91011795549795,
        72.74015350735679, 72.48300140782715, 78.97069839806582, 83.73964562118616,
        83.84574408378326, 71.33039023613085, 71.26917949037372, 72.17283464170444,
        72.08743120547791, 67.47526238528283, 61.16236712437612, 60.70620392725001,
        59.81373027048637, 51.22266372104144,  52.7024964741784, 54.42543373071069,
        55.89839001638181, 49.31695763610402, 48.95265183581961, 59.85493154117109,
        66.98103363016929, 66.55986247555725, 60.94079993695092, 60.81396387410788,
        66.3995662466987, 66.38241710471118,  65.3506056073515, 73.42013137042728,
        80.58030687035495, 79.67708550553732, 79.01479607200554, 87.34508715847923,
        77.04210310304457, 67.95115426159542, 67.42964923254911, 68.95295552561937,
        75.58619102833927, 80.88448734769928, 75.44325780921399, 75.55753435641843,
        70.0906077677646, 70.22512288789831,  70.6072592826845, 71.43942126312018,
        65.44767654763557, 65.68749110206589, 74.36441225839252, 82.36854172002271,
        73.83342055502999, 63.78386833862116, 57.45778188795012, 57.68265440235836,
        56.23952862297446,  55.2773073639795, 60.12554667005146, 52.87578243626421,
        44.91807978584161, 43.30109133170315, 49.99394260133146, 50.31590299140161,
        41.66989607882265,   42.354297964064, 49.67572669688681, 59.99156677070005,
        67.02467811570102, 68.23736235499952, 76.08368950282885, 68.61011631121399,
        62.93469466491609, 72.71977905824173, 79.15363768969728, 78.97584748189118,
        79.30495595936318, 79.91759225129061, 78.66002584463985, 78.89088669128908,
        79.6987109839671, 71.37138289928748, 64.34441597338702, 64.11451547968605,
        64.66424471526491, 72.11459086157126, 77.96740309161811, 76.27534894255712,
        67.72770112091345, 62.28962622900987, 62.78340216643917, 62.86558154757148,
        63.61032330840616, 63.80198463850583, 57.32298140186576, 65.40806550256059,
        63.72032644945094, 64.87224765387543,  66.5898176997807, 59.23993768100337,
        50.49956920562019, 43.34154061955358, 50.67722391319419, 56.67756029979644,
        56.67088869083736,  50.2640158783402, 50.28627467146799, 50.11476037670018,
        55.68082118815894, 49.51578458676631, 51.52388148401312, 43.04854099241449,
        38.90924544853939, 39.52607999487414, 41.19046047379119, 40.22508230169954,
        30.65673811393943, 33.03337622190978, 24.72671702083193, 22.02040486517996,
        33.12026973589957, 38.19879407932927, 40.25392803859621, 39.14341514092913,
        37.49947456325954,  36.3733600363657, 39.51751154097627, 38.06664357075233,
        35.79789960710492, 43.49094936188671, 43.02975409829144, 44.14097096371184,
        44.73027852610545,  52.6663068069408, 43.90370609799768, 36.08702573844689,
        36.32955791658276, 42.44761177484342, 48.22912597881331, 49.38305050711481,
        47.58063402560765, 53.40142552666631, 56.93784014985063, 49.66090776623523,
        52.44840586902816, 50.80200449592628, 58.64775601270109, 57.47575498291298,
        67.38727655236582, 76.26434567414708,  75.7642793409255, 68.54997314050436,
        67.21600347631244,
};

float MFI_REF_FLOAT[data_len] = {0};

const double NVI_REF_DOUBLE[data_len] = {
        1000,              1000, 1003.593737911836, 1006.892108332297,
        1006.892108332297, 1005.339199976112, 1005.339199976112, 1005.339199976112,
        1005.339199976112, 1005.339199976112, 1005.339199976112, 998.7967112283008,
        1011.213051254463, 1011.213051254463, 1011.213051254463, 1011.412407674455,
        1011.412407674455, 1011.412407674455, 1011.412407674455, 1027.423367704549,
        1039.731067255282, 1039.731067255282, 1033.823493495377, 1033.823493495377,
        1053.642876747774, 1053.642876747774, 1053.642876747774, 1049.596251290254,
        1049.596251290254, 1049.596251290254, 1055.040080497466, 1055.040080497466,
        1055.040080497466,  1093.63759794929, 1111.292588429597, 1127.608317264604,
        1127.608317264604, 1142.018505633158, 1142.018505633158, 1138.383954466957,
        1138.383954466957, 1130.116589526555, 1136.859493249402, 1136.859493249402,
        1133.536838728003, 1133.536838728003, 1133.536838728003, 1132.396361978452,
        1132.396361978452, 1132.396361978452, 1132.056314351296, 1132.056314351296,
        1152.819097914869,  1159.56838318184, 1169.177637849277, 1169.177637849277,
        1169.177637849277, 1176.308914015804, 1187.941015456624, 1187.941015456624,
        1197.067717502626, 1208.314171486696,  1204.13352000436, 1197.362144340771,
        1197.362144340771, 1197.362144340771, 1197.362144340771, 1206.722827082112,
        1205.740541738847, 1196.206518264012, 1196.206518264012, 1196.206518264012,
        1196.206518264012, 1196.206518264012, 1170.321650490865,  1145.55983223793,
        1145.55983223793, 1167.245741284034, 1179.332914591137, 1205.344126795385,
        1190.886940999527, 1187.865083977869, 1187.865083977869, 1152.508229047254,
        1146.767032752326, 1146.767032752326, 1168.147468377986, 1168.147468377986,
        1180.808496515207, 1180.808496515207, 1180.808496515207, 1203.242960682543,
        1189.66575484329, 1197.648886229821, 1197.648886229821, 1197.648886229821,
        1180.206795072787, 1200.230750716491, 1200.230750716491, 1200.118178435687,
        1200.118178435687, 1200.118178435687, 1200.118178435687, 1197.434430951663,
        1197.434430951663, 1203.729481973322, 1208.108687171331, 1208.108687171331,
        1198.292854428185, 1198.292854428185, 1203.741418884816, 1203.741418884816,
        1222.266506653046, 1215.962458225735, 1215.962458225735, 1215.962458225735,
        1215.962458225735, 1185.480890096477, 1195.551196933741, 1195.551196933741,
        1195.814538406879,  1181.80559150545, 1195.656548269234, 1195.656548269234,
        1195.656548269234, 1193.935462954291, 1191.151513357823, 1186.342707485621,
        1190.948999383962, 1190.948999383962, 1211.603286835069, 1208.832644107644,
        1225.05378128393, 1227.068883480259, 1227.068883480259, 1227.068883480259,
        1227.068883480259, 1226.917584152602, 1226.917584152602, 1226.917584152602,
        1234.974862303459, 1233.200359296943,  1233.72784943376,  1233.72784943376,
        1237.104382366522, 1237.104382366522, 1237.104382366522, 1237.104382366522,
        1228.544304884352, 1228.544304884352, 1234.738782580104, 1230.994362186218,
        1230.994362186218, 1230.994362186218, 1229.913707885106, 1229.913707885106,
        1229.913707885106,  1246.43411170451, 1243.688475686172, 1243.688475686172,
        1243.688475686172, 1254.665616239069, 1254.665616239069, 1254.665616239069,
        1254.665616239069, 1261.998434149586, 1272.762545188888, 1272.762545188888,
        1290.06342843409, 1312.146609498428, 1314.725418919896, 1314.725418919896,
        1316.041361637175, 1316.041361637175, 1337.516976917849,  1338.78850815405,
        1338.78850815405,  1338.78850815405, 1346.734393827494, 1356.574374277427,
        1356.574374277427, 1356.574374277427, 1367.383891003487, 1360.953022277269,
        1360.953022277269, 1360.953022277269, 1364.029735137961, 1393.171368170297,
        1393.171368170297,  1387.20090157305, 1404.577644884017, 1404.577644884017,
        1395.058951235617, 1400.038651002914, 1400.038651002914, 1400.038651002914,
        1400.038651002914, 1400.038651002914, 1400.038651002914, 1398.009855374483,
        1398.009855374483, 1394.170506963336, 1440.197203231692, 1451.941036692952,
        1468.924292575374, 1468.924292575374, 1475.900978428338, 1466.996445905532,
        1466.996445905532,  1456.54984892344, 1456.908603967166, 1456.908603967166,
        1478.00863677527,  1478.00863677527,  1478.00863677527,  1478.00863677527,
        1478.00863677527, 1501.455283959836, 1501.455283959836, 1501.455283959836,
        1641.241860607829, 1589.117197476605,  1662.82770922543, 1608.890567126838,
        1608.890567126838, 1608.890567126838, 1724.765396425065, 1664.863418109805,
        1664.863418109805, 1864.327814745023, 1624.487719664708, 1624.487719664708,
        1584.720323404247,  1572.57810971471,  1572.57810971471, 1539.170017963483,
        1693.587869138539, 1693.587869138539, 1782.709535502206, 1708.901353587144,
        1757.669902726197, 1757.669902726197, 1665.186499479937, 1692.972939643118,
        1668.642533832665, 1668.642533832665, 1668.642533832665, 1711.350817703468,
        1723.700065610342, 1757.532223229778, 1757.532223229778, 1741.490677054201,
        1741.490677054201,
};

float NVI_REF_FLOAT[data_len] = {0};

const double OBV_REF_DOUBLE[data_len] = {
        25696400,          54603200,          78799000,          98238500,
        121561500,         104020900,          85477700,          66828600,
        89033300,          42498400,         107325700,          75329400,
        96221800,          63778700,          25015000,          51354500,
        16445900,         -24762800,         -82193400,         -45663700,
        -19119000,         -52150400,         -85029500,        -123641800,
        -95277000,        -125025600,        -161555300,        -185270000,
        -213218200,        -241699400,        -220481000,        -247524600,
        -287920700,        -256952700,        -227179300,        -204653000,
        -173968600,        -147747700,        -120814800,        -139036600,
        -160711200,        -179472700,        -164803600,        -138252600,
        -159376800,        -137862800,        -185663400,        -203883800,
        -224954100,        -198886600,        -219786300,        -250896900,
        -223580200,        -206645000,        -195283000,        -212548500,
        -237887100,        -217309100,        -199412000,        -219603800,
        -202008600,        -185061200,        -201928000,        -216035500,
        -197453300,        -218382600,        -196104700,        -177749500,
        -192741100,        -206650700,        -189031800,        -167358400,
        -201294100,        -132012700,        -186030600,        -226892700,
        -279285700,        -243460900,        -210096500,        -183087000,
        -207706700,        -230181600,        -182963100,        -219510500,
        -246737900,        -219117500,        -194703900,        -167819600,
        -146284200,        -168537900,        -215355900,        -189312300,
        -215185600,        -199246800,        -178256300,        -199399700,
        -219422700,        -200234600,        -176320900,        -195683200,
        -168373800,        -136595900,         -92306300,        -124533000,
        -164296300,        -143138200,        -124819500,         -99479500,
        -121540100,        -176953200,        -157787700,        -188978500,
        -167075100,        -185908600,        -211260600,        -185283200,
        -150477400,        -185089700,        -156483200,        -121863500,
        -91287000,        -119242000,        -100549400,         -72296000,
        -30597100,         -54704000,         -76544000,         -95019800,
        -78123500,         -53765100,         -31953300,         -52526700,
        -33569500,         -16250700,           2118600,          26261800,
        -9448100,         -40578600,          -5788100,          31993200,
        57811200,          37836800,          56802900,          80538000,
        98034600,         118489900,          96642700,         122326300,
        100030600,         125082200,         146758000,         127716200,
        101157600,          70808800,          54477500,          75482600,
        49180700,          65489600,          53835200,          30213400,
        1605800,          18401200,          37007300,          63526200,
        31515600,          54120700,          73809900,         108137500,
        141534400,         173580900,         202120500,         173113400,
        197705700,         128711200,         153354200,         165473900,
        188754200,         152187700,         188216300,         213417700,
        247287800,         210707100,         240303900,         213085900,
        246105700,         288632800,         323794000,         354177000,
        313688400,         283207500,         310414800,         344868900,
        317158100,         342616200,         368734200,         332099800,
        291614800,         332173300,         386230600,         354544800,
        304647700,         261151300,         295305400,         325012100,
        351368500,         321947500,         349284700,         325703900,
        354136500,         330449600,         350478000,         312345200,
        335841200,         310699700,         278311200,         222762400,
        165094000,         214607700,         134456300,          27735100,
        113084400,          33215500,          88010100,          41116900,
        -15427300,         -87113500,         -15791000,         -79690700,
        -184309200,         -91626200,        -172232100,         -91218100,
        -166276500,        -234240800,        -334664100,        -418852300,
        -346969500,        -422870000,        -359848200,        -410902400,
        -368908300,        -418158800,        -462213400,        -420729900,
        -453199900,        -402744800,        -453466600,        -411242800,
        -370713700,        -337958000,        -289209300,        -321940700,
        -288751199,
};

float OBV_REF_FLOAT[data_len] = {0};

const double VPT_REF_DOUBLE[data_len] = {
        0, 562903.5309109169, 649856.8946781246, 713745.9658893028,
        1050140.530830358, 1023088.035248083, 854805.9921757173, 765776.1622233124,
        799468.8322650247,-96614.66662856261, 3085471.845196695, 2877248.160368149,
        3136967.820481553, 2635956.879407646, 1591003.865395213, 1596196.587559791,
        1221132.487558881,  494353.258070935,-2843481.410354072,-2265205.365712552,
        -1947221.365607262,-2092550.530519571,-2279363.942685888, -3486765.25194091,
        -2942984.959062432,-3551987.405933735,-4175537.476920992,-4266616.257839307,
        -4382176.450192437,-4518005.234417959,-4407954.016620328,-4897862.700612891,
        -5306277.938663348, -4173346.64766966,-3692703.796187563,-3361978.111266563,
        -2545252.72312017,-2210164.641196801,-1898292.906620746,-1956285.018056425,
        -1960750.528061415,-2097003.473933254,-2009479.469845987,-1385040.316086434,
        -1446779.184484603,-1273900.430593695,-1436864.379576207,-1455196.331267182,
        -1774571.379155941,-1210755.779711798,-1217031.756597546,-1500507.817260507,
        -999498.5277217079,-900349.8442379369,-806193.8176379069,-821398.2012941971,
        -1343727.464284535,-1218214.115239708, -1041236.04407488,-1188280.200060594,
        -1053099.96320508,-893879.1008738584,-952236.6159028397,-1031569.331575211,
        -820480.8458655057,-1132904.832954406,-623764.2513557993,-480267.8123995978,
        -492471.1358319558,-602457.0310846111,-541179.7372299563,-338781.8605224837,
        -484441.567721155, 929191.6812741258,-239708.6528523436,-1104274.298723184,
        -3846935.058322031,-3168757.164394698,-2823258.979373376,-2227540.987160628,
        -2522835.558416892,-2579865.266307591,-580237.8267075787, -1668072.74779465,
        -1803705.486946316, -1152010.42082396,-696840.8979106414,-695563.4623468856,
        -462150.890109832,-480987.8351306984,-2644939.258440217,-2150130.648311865,
        -2442080.928778466,-2335125.227964509,-1979717.957038574,-2007030.079437314,
        -2298637.240144243,-1973082.714538199,-1505531.874040096,-1507347.906724904,
        -1390815.80266948,-1015422.162230165, 392770.2878620236, 320703.7809150838,
        -452852.0308246796,-341621.4568754223,-274977.4579851798,-37306.51057687346,
        -216547.9663439629,-1026581.080364004,-939436.7218645897,-1087748.176592501,
        -750663.815236424,-847800.8106539567,-971164.4802494954,-359778.6386632636,
        -263429.0299002521,-1131085.077521807,-888081.3859846541, 82372.01846433652,
        89107.037904779,-238385.3098226287,-19304.94985167278, 361505.1616781282,
        1470626.510386825, 1435925.883656815, 1385000.635958397, 1310411.858177167,
        1376016.24830057, 1493005.001738978,  1871280.80301937,  1824234.42925349,
        2078618.146616859, 2107105.999518474, 2333347.478899036, 2575190.806255324,
        1749294.887277962, 1745456.452628494, 2532054.142067732, 3604318.319334663,
        3773867.447968684, 3745166.756209458, 3753279.331435751, 3955347.214447648,
        4003232.853195669, 4165214.302432151, 4145215.116500762, 4391306.485606056,
        4237032.584195966, 4534629.531645119, 4643921.690750622, 4586176.275070624,
        4276995.144996007, 4140928.649546081, 4126591.874228601, 4494890.924377196,
        4289508.993978465, 4508572.829207666, 4482900.601440758, 4209780.797838139,
        3699705.218269326, 3847946.092126752, 4120916.868131218, 4633162.028665844,
        4185009.120386958, 4317123.270965093, 4485060.670362771,  4572537.54600426,
        5026507.432088505, 5575076.321323153, 5631166.234471691, 5561856.428037679,
        5586471.497937768, 5443567.724480717, 5845700.668618044, 5857222.449193045,
        6319111.661158013, 6305235.285701854, 6519069.759803357, 6703205.016500968,
        7475996.029877251, 7120357.217107926, 7356191.765293516, 7228184.271463998,
        7759350.204555286, 8662660.504283775, 8742149.593522398, 9391263.182187613,
        8844534.47211897, 8713907.903513087,  9054719.58244752, 9436160.821980933,
        9248367.27641738,  9339240.63666752, 9465021.286250873, 9359441.851091813,
        8168970.186390913, 9316343.129088841, 10447888.71879299, 10401972.83462988,
        8189598.676463423, 8070144.701522836, 9197697.163124563,  9439935.19601392,
        9748224.220173609, 9279602.256366841, 9409440.844688682, 9267171.137179317,
        9942382.212578608, 9773705.936132444, 9778639.024775485, 9080406.652980402,
        9420693.181256264, 9162767.350713868, 8429652.665114816, 5791063.270707948,
        3837708.922046464, 4623178.117433157,-616175.0832950771,-678604.9588856327,
        7267476.815083224, 4730897.894521463,  7272521.64227631, 5751446.922493174,
        5000532.953297084,-669278.2568299277, 4467480.377650429, 2248211.338692783,
        -8083353.699485545, 3020835.672595833,-7348867.856543639,-3786675.589582509,
        -5624102.305305737,-6144848.484724361,-12520277.38347274,-14308784.48057388,
        -7097113.65610378,-7515230.772961831,-4198834.892011942,-6312593.530805795,
        -5114167.81413036, -5214676.06126947,-7532699.104352416,-6840477.067439824,
        -7307116.703648037,-2905541.636217514, -3493017.07031255,-2412314.643075476,
        -2119853.332299852,-1476936.372763411, 985026.9392790373, 686277.2164851144,
        934822.7454986617,
};

float VPT_REF_FLOAT[data_len] = {0};

const double VWAP_REF_DOUBLE[data_len] = {
        -1,               -1,               -1,               -1,
        -1,               -1,               -1,               -1,
        -1,               -1,               -1,               -1,
        -1,               -1,  205.977105560346, 206.2067215308933,
        205.9640268864144, 205.1517129697552, 202.7979074511401, 201.4643626658682,
        200.5816022309909, 199.6988307196843, 198.8478530651935, 197.3963280558047,
        196.4448586174185, 193.5403454531355, 191.3429985803694, 189.9055252698924,
        188.0904697216952, 186.6178923338884, 185.2384075567195, 183.6675856196864,
        182.4326512071125, 181.6383814083714, 181.2346101416828,  180.669727752373,
        180.6553904932713, 181.2862153971433, 181.8283973863227, 182.2792257867036,
        183.2900840023258,  183.957490983561, 184.7505923693591, 186.3130185931346,
        187.5204973554474, 189.1374514999147, 192.2212655668682, 193.8560572657389,
        195.0066293351742, 196.0541122073621, 196.9532100762431, 197.3599873883642,
        197.9626427868622,  198.376325583696, 198.8050727727138, 199.4718340458877,
        199.7635142286938,  199.955896118243, 200.2202009953149, 200.4274702212012,
        200.7838279432747, 201.1450204957219, 201.6811580537913, 202.0139957161611,
        202.3555472839069, 202.9710558126025, 203.3142866119441, 203.7314113031736,
        203.9896181294896, 204.1818774445875, 204.8924752200705, 205.6534218210762,
        206.2334474225591, 208.4310065871079, 209.0957967972096, 208.7296848938533,
        207.1339460831548, 206.3516200104331, 205.7451048330307, 205.6185635572839,
        205.3514003673945,  204.999294091721, 205.1082046530107, 204.9558891140883,
        204.7038123036408, 204.5636346246935, 204.5941634746463, 203.4372310119639,
        202.959199121128, 203.3546742506622, 204.6123906041573, 205.4283793431192,
        206.0802864536755, 206.3016754267558, 206.7426031789113,   207.20964400628,
        207.1244565997756, 207.5476322138323, 208.3488498332076, 208.8489275538436,
        209.0990158733243, 209.4765944772453, 210.7711784931005, 211.8133555521839,
        213.4122748150772, 214.2636262769813,  215.214593628792, 216.1167073384376,
        216.8998825314331, 217.6539637536879, 218.3087298946716, 218.8202451730258,
        219.222239473558,  219.528808012376, 219.8754268290299, 220.4665362230596,
        220.7922362809225,   220.46385212031, 220.5195191788212, 221.0804041128445,
        221.6080866326007, 221.8744860781458,  222.110851820917, 223.0589742808459,
        224.539806298143, 225.6779594265056, 226.5647752058152, 227.2426082421492,
        228.1189556077348, 228.9601430506284, 229.8909677725728,  231.445123009575,
        233.0715500224952,  234.335845871279, 235.6162170760768,  237.477696954379,
        238.9065174698172, 240.1215146454091, 241.2459783928365, 242.9680469542059,
        244.4507875896417, 245.7251847289845, 246.8394075676161, 248.4362683016394,
        249.5382583343128,  250.751502673933, 251.8992559063424, 253.1458456606211,
        254.1648348078018, 255.2967179270536, 257.0213337307241, 258.8447370170703,
        260.6700611600658, 261.6678157712328, 262.0787657930364, 262.5968305730863,
        263.1186291515258, 263.6170870347939, 264.0054632576245,  264.304699589529,
        263.9374434259423, 263.8678235236299, 263.9699887263454, 264.3955722399259,
        264.5884032400511, 264.7228797538336, 265.1937372940749, 266.0369956652556,
        267.0207218773212,  268.278445095364, 269.5527406707366, 270.5356513101094,
        271.2770903998476,  273.101044468232, 274.7056001158523,  275.510999927128,
        276.7152038109429, 278.3643628239699, 280.1461665632561, 281.4937496089573,
        283.3172423845214, 285.5317010980781, 287.2238408438735, 288.5425055957405,
        290.0525905143633, 292.4291746760844,  294.444834549943, 298.2177822155005,
        300.5315945683481, 301.7339420325665, 303.1515094866987, 305.2109026581093,
        307.1650963588441, 308.6169385278818, 309.9259162303556, 311.6928008577632,
        312.3313805901195, 313.4308785621861,  315.444998066406,  316.484286856797,
        316.6136303898261, 315.9805009497913, 316.2235162731428, 316.7977654762094,
        317.2871981469989, 317.4623907639696, 317.5611896549861, 317.6732516823395,
        318.0854896865847, 318.2915197028748, 319.4188476306156,  319.576765592714,
        319.126592516213, 319.0081059522554, 319.3400540658276, 317.5620693822539,
        314.2657041665884, 311.4291359677803, 305.5211651622387, 298.2605533397456,
        296.65278848799, 295.4397724741918, 294.6037656502157, 293.6582844215105,
        292.4028650391228, 289.2065539723329, 287.5845604385358, 285.8628074606639,
        281.6794618100301, 279.8017381706222, 276.5911954610253,   273.83626875735,
        271.5135257129737, 270.1032844309665, 265.0297880468024, 259.4442026495203,
        256.26856143789, 254.1521755210274, 252.4883040722403, 251.2833987082711,
        249.3928952094091,  248.072423987546, 247.0565539463359, 244.5254176131576,
        244.1976099850604, 244.5190737391006, 245.6715867701851, 246.5958914091638,
        249.1377171668284, 253.5183387541152, 256.9292083872347,  259.269002792479,
        261.2601638532001,
};

float VWAP_REF_FLOAT[data_len] = {0};

TEST(momentum_backend, ADIDouble) {
    double* out = _ADI_DOUBLE(SAMPLE_HIGH_DOUBLE, SAMPLE_LOW_DOUBLE, SAMPLE_CLOSE_DOUBLE, SAMPLE_VOLUME_DOUBLE, data_len);
    for (int i=0; i<data_len; i++) {
        ASSERT_DOUBLE_EQ(ADI_REF_DOUBLE[i], out[i]);
    }

    free(out);
}

TEST(momentum_backend, ADIFloat) {
    float* out = _ADI_FLOAT(SAMPLE_HIGH_FLOAT, SAMPLE_LOW_FLOAT, SAMPLE_CLOSE_FLOAT, SAMPLE_VOLUME_FLOAT, data_len);
    double max_fp_error = get_max_fp_error(ADI_REF_DOUBLE, data_len);
    for (int i=0; i<data_len; i++) {
        ASSERT_NEAR(ADI_REF_FLOAT[i], out[i], max_fp_error);
    }

    free(out);
}

TEST(momentum_backend, CMFDouble) {
    double* out = _CMF_DOUBLE(SAMPLE_HIGH_DOUBLE, SAMPLE_LOW_DOUBLE, SAMPLE_CLOSE_DOUBLE, SAMPLE_VOLUME_DOUBLE, data_len, 20);
    for (int i=0; i<data_len; i++) {
        ASSERT_DOUBLE_EQ(CMF_REF_DOUBLE[i], out[i]);
    }

    free(out);
}

TEST(momentum_backend, CMFFloat) {
    float* out = _CMF_FLOAT(SAMPLE_HIGH_FLOAT, SAMPLE_LOW_FLOAT, SAMPLE_CLOSE_FLOAT, SAMPLE_VOLUME_FLOAT, data_len, 20);
    double max_fp_error = get_max_fp_error(CMF_REF_DOUBLE, data_len);
    for (int i=0; i<data_len; i++) {
        ASSERT_NEAR(CMF_REF_FLOAT[i], out[i], max_fp_error);
    }

    free(out);
}

TEST(momentum_backend, EMVDouble) {
    double** out = _EMV_DOUBLE(SAMPLE_HIGH_DOUBLE, SAMPLE_LOW_DOUBLE, SAMPLE_VOLUME_DOUBLE, data_len, 14);
    for (int i=1; i<data_len; i++) {
        ASSERT_DOUBLE_EQ(EMV_REF_DOUBLE[i], out[0][i]);
        ASSERT_DOUBLE_EQ(EMV_SMA_REF_DOUBLE[i], out[1][i]);
    }

    free(out[0]);
    free(out[1]);
    free(out);
}

TEST(momentum_backend, EMVFloat) {
    float** out = _EMV_FLOAT(SAMPLE_HIGH_FLOAT, SAMPLE_LOW_FLOAT, SAMPLE_VOLUME_FLOAT, data_len, 14);
    double max_fp_error1 = get_max_fp_error(EMV_REF_DOUBLE, data_len);
    double max_fp_error2 = get_max_fp_error(EMV_SMA_REF_DOUBLE, data_len);
    for (int i=1; i<data_len; i++) {
        ASSERT_NEAR(EMV_REF_FLOAT[i], out[0][i], max_fp_error1);
        ASSERT_NEAR(EMV_SMA_REF_FLOAT[i], out[1][i], max_fp_error2);
    }

    free(out[0]);
    free(out[1]);
    free(out);
}

TEST(momentum_backend, FIDouble) {
    double* out = _FI_DOUBLE(SAMPLE_CLOSE_DOUBLE, SAMPLE_VOLUME_DOUBLE, data_len, 13);
    for (int i=1; i<data_len; i++) {
        ASSERT_DOUBLE_EQ(FI_REF_DOUBLE[i], out[i]);
    }

    free(out);
}

TEST(momentum_backend, FIFloat) {
    float* out = _FI_FLOAT(SAMPLE_CLOSE_FLOAT, SAMPLE_VOLUME_FLOAT, data_len, 13);
    double max_fp_error = get_max_fp_error(FI_REF_DOUBLE, data_len);
    for (int i=1; i<data_len; i++) {
        ASSERT_NEAR(FI_REF_FLOAT[i], out[i], max_fp_error);
    }

    free(out);
}

TEST(momentum_backend, MFIDouble) {
    double* out = _MFI_DOUBLE(SAMPLE_HIGH_DOUBLE, SAMPLE_LOW_DOUBLE, SAMPLE_CLOSE_DOUBLE, SAMPLE_VOLUME_DOUBLE, data_len, 14);
    for (int i=14; i<data_len; i++) {
        ASSERT_DOUBLE_EQ(MFI_REF_DOUBLE[i], out[i]);
    }

    free(out);
}

TEST(momentum_backend, MFIFloat) {
    float* out = _MFI_FLOAT(SAMPLE_HIGH_FLOAT, SAMPLE_LOW_FLOAT, SAMPLE_CLOSE_FLOAT, SAMPLE_VOLUME_FLOAT, data_len, 14);
    double max_fp_error = get_max_fp_error(MFI_REF_DOUBLE, data_len);
    for (int i=14; i<data_len; i++) {
        ASSERT_NEAR(MFI_REF_FLOAT[i], out[i], max_fp_error);
    }

    free(out);
}

TEST(momentum_backend, NVIDouble) {
    double* out = _NVI_DOUBLE(SAMPLE_CLOSE_DOUBLE, SAMPLE_VOLUME_DOUBLE, data_len);
    for (int i=14; i<data_len; i++) {
        ASSERT_DOUBLE_EQ(NVI_REF_DOUBLE[i], out[i]);
    }

    free(out);
}

TEST(momentum_backend, NVIFloat) {
    float* out = _NVI_FLOAT(SAMPLE_CLOSE_FLOAT, SAMPLE_VOLUME_FLOAT, data_len);
    double max_fp_error = get_max_fp_error(MFI_REF_DOUBLE, data_len);
    for (int i=14; i<data_len; i++) {
        ASSERT_NEAR(NVI_REF_FLOAT[i], out[i], max_fp_error);
    }

    free(out);
}

TEST(momentum_backend, OBVDouble) {
    double* out = _OBV_DOUBLE(SAMPLE_CLOSE_DOUBLE, SAMPLE_VOLUME_DOUBLE, data_len);
    for (int i=14; i<data_len; i++) {
        ASSERT_DOUBLE_EQ(OBV_REF_DOUBLE[i], out[i]);
    }

    free(out);
}

TEST(momentum_backend, OBVFloat) {
    float* out = _OBV_FLOAT(SAMPLE_CLOSE_FLOAT, SAMPLE_VOLUME_FLOAT, data_len);
    double max_fp_error = get_max_fp_error(OBV_REF_DOUBLE, data_len);
    for (int i=14; i<data_len; i++) {
        ASSERT_NEAR(OBV_REF_FLOAT[i], out[i], max_fp_error);
    }

    free(out);
}

TEST(momentum_backend, VPTDouble) {
    double* out = _VPT_DOUBLE(SAMPLE_CLOSE_DOUBLE, SAMPLE_VOLUME_DOUBLE, data_len);
    for (int i=14; i<data_len; i++) {
        ASSERT_DOUBLE_EQ(VPT_REF_DOUBLE[i], out[i]);
    }

    free(out);
}

TEST(momentum_backend, VPTFloat) {
    float* out = _VPT_FLOAT(SAMPLE_CLOSE_FLOAT, SAMPLE_VOLUME_FLOAT, data_len);
    double max_fp_error = get_max_fp_error(VPT_REF_DOUBLE, data_len);
    for (int i=14; i<data_len; i++) {
        ASSERT_NEAR(VPT_REF_FLOAT[i], out[i], max_fp_error);
    }

    free(out);
}

TEST(momentum_backend, VWAPDouble) {
    double* out = _VWAP_DOUBLE(SAMPLE_HIGH_DOUBLE, SAMPLE_LOW_DOUBLE, SAMPLE_CLOSE_DOUBLE, SAMPLE_VOLUME_DOUBLE, data_len, 14);
    for (int i=14; i<data_len; i++) {
        ASSERT_DOUBLE_EQ(VWAP_REF_DOUBLE[i], out[i]);
    }

    free(out);
}

TEST(momentum_backend, VWAPFloat) {
    float* out = _VWAP_FLOAT(SAMPLE_HIGH_FLOAT, SAMPLE_LOW_FLOAT, SAMPLE_CLOSE_FLOAT, SAMPLE_VOLUME_FLOAT, data_len, 14);
    double max_fp_error = get_max_fp_error(VWAP_REF_DOUBLE, data_len);
    for (int i=14; i<data_len; i++) {
        ASSERT_NEAR(VWAP_REF_FLOAT[i], out[i], max_fp_error);
    }

    free(out);
}

int main(int argc, char* argv[]) {
    populate_float_arrays();
    for (int i=0; i<data_len; i++) {
        ADI_REF_FLOAT[i] = (float)ADI_REF_DOUBLE[i];
    }
    for (int i=0; i<data_len; i++) {
        CMF_REF_FLOAT[i] = (float)CMF_REF_DOUBLE[i];
    }
    for (int i=0; i<data_len; i++) {
        EMV_REF_FLOAT[i] = (float)EMV_REF_DOUBLE[i];
    }
    for (int i=0; i<data_len; i++) {
        EMV_SMA_REF_FLOAT[i] = (float)EMV_SMA_REF_DOUBLE[i];
    }
    for (int i=0; i<data_len; i++) {
        FI_REF_FLOAT[i] = (float)FI_REF_DOUBLE[i];
    }
    for (int i=0; i<data_len; i++) {
        MFI_REF_FLOAT[i] = (float)MFI_REF_DOUBLE[i];
    }
    for (int i=0; i<data_len; i++) {
        NVI_REF_FLOAT[i] = (float)NVI_REF_DOUBLE[i];
    }
    for (int i=0; i<data_len; i++) {
        OBV_REF_FLOAT[i] = (float)OBV_REF_DOUBLE[i];
    }
    for (int i=0; i<data_len; i++) {
        VPT_REF_FLOAT[i] = (float)VPT_REF_DOUBLE[i];
    }
    for (int i=0; i<data_len; i++) {
        VWAP_REF_FLOAT[i] = (float)VWAP_REF_DOUBLE[i];
    }
    testing::InitGoogleTest(&argc, argv);
    return RUN_ALL_TESTS();
}